/*===========================================================================+
|  Class    : Splash                                                         |
|  Task     : Splash header file                                             |
|----------------------------------------------------------------------------|
|  Compile  :                                                                |
|  Link     :                                                                |
|  Call     :                                                                |
|----------------------------------------------------------------------------|
|  Author   : C.C. Chen                                                      |
|  Version  : V1.00                                                          |
|  Creation : 10/21/1997                                                     |
|  Revision :                                                                |
+===========================================================================*/

#ifndef     D_SPLASH
#define     D_SPLASH

#include    "wnd.h"
#include    "task.h"

/*===========================================================================+
|           Constant                                                         |
+===========================================================================*/

/*===========================================================================+
|           Type definition                                                  |
+===========================================================================*/

/*===========================================================================+
|           Class declaration - CtmWndSplash                                   |
+===========================================================================*/
class CtmWndSplash : public CtmWnd
{
/*---------------------------------------------------------------------------+
|           Constructor and destructor                                       |
+---------------------------------------------------------------------------*/
DECLARE_DYNCREATE(CtmWndSplash)
public:
    CtmWndSplash();
    ~CtmWndSplash();
    
/*---------------------------------------------------------------------------+
|           Attributes                                                       |
+---------------------------------------------------------------------------*/
private:
    BOOL    	m_bKeyIn;
	CtmBitMap*	m_pbmpLogo;
	
	char*		m_pszLogo;	//	fans add
	char*		m_pszVersion;
	char*		m_pszVersionID;
	int			m_iTextLeft;
	int			m_iTextTop;
/*---------------------------------------------------------------------------+
|           Operations                                                       |
+---------------------------------------------------------------------------*/
public:
    WORD    OnKey(WORD wKey);           // Virtual function
    BOOL    IsKeyIn()                   {return m_bKeyIn;};
    
    
    //	fans add
    BOOL 	CreateA();
	void 	SetPropertys();
	void 	SetPropertys_Nub();
	void    Show();
	void	WndProc(int message, WPARAM wParam, LPARAM lParam);
/*---------------------------------------------------------------------------+
|           Helpers                                                          |
+---------------------------------------------------------------------------*/
private:
};

/*===========================================================================+
|           External                                                         |
+===========================================================================*/

/*===========================================================================+
|           Class declaration - CTaskSplash                                  |
+===========================================================================*/
class CTaskSplash : public CTask
{
/*---------------------------------------------------------------------------+
|           Constructor and destructor                                       |
+---------------------------------------------------------------------------*/
public:
    CTaskSplash();
    ~CTaskSplash();
    
/*---------------------------------------------------------------------------+
|           Attributes                                                       |
+---------------------------------------------------------------------------*/
public:
    //CtmWndSplash  m_wndSplash;	//fans mark
    CtmWndSplash*  m_wndSplash;	//fans add
private:
	static  	WORD    m_wTasksCount;
	
	//	fans add
	CParseObject	m_parseSplash;

/*---------------------------------------------------------------------------+
|           Operations                                                       |
+---------------------------------------------------------------------------*/
public:
    void    Run();

/*---------------------------------------------------------------------------+
|           Helpers                                                          |
+---------------------------------------------------------------------------*/
private:
};

/*===========================================================================+
|           Class declaration - CtmWndStart                                    |
+===========================================================================*/
class CtmWndStart : public CtmWnd
{
/*---------------------------------------------------------------------------+
|           Constructor and destructor                                       |
+---------------------------------------------------------------------------*/
public:
    CtmWndStart();
    ~CtmWndStart();
    
/*---------------------------------------------------------------------------+
|           Attributes                                                       |
+---------------------------------------------------------------------------*/
private:

/*---------------------------------------------------------------------------+
|           Operations                                                       |
+---------------------------------------------------------------------------*/
public:

/*---------------------------------------------------------------------------+
|           Helpers                                                          |
+---------------------------------------------------------------------------*/
private:
};

extern	WORD	g_wExternLogoTime;
#endif
