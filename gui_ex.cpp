/*==========================================================================+
|  Class    :                                                  				|
|  Task     :                                                               |
|---------------------------------------------------------------------------|
|  Compile  : Gcc V3.2.2                                                    |
|  Link     : Gcc V3.2.2                                                    |
|  Call     :                                                               |
|---------------------------------------------------------------------------|
|  Author   : fans                                               			|
|  Version  : V1.00                                                         |
|  Creation : 2006/11/22                                                    |
|  Remark	: extend gui		                       						|
+==========================================================================*/

#include	<memory.h>
#include	"gui_ex.h"
#include	"common.h"
#include	"utils.h"
//#include	"memwatch.h"

int	Sin[] = //	0 to 360.0, 
{
0	 ,2    ,4    ,5    ,7    ,9    ,11   ,13   ,14   ,16   ,18   ,20   ,21   ,
23   ,25   ,27   ,29   ,30   ,32   ,34   ,36   ,38   ,39   ,41   ,43   ,45   ,
46   ,48   ,50   ,52   ,54   ,55   ,57   ,59   ,61   ,63   ,64   ,66   ,68   ,
70   ,71   ,73   ,75   ,77   ,79   ,80   ,82   ,84   ,86   ,87   ,89   ,91   ,
93   ,95   ,96   ,98   ,100  ,102  ,103  ,105  ,107  ,109  ,111  ,112  ,114  ,
116  ,118  ,119  ,121  ,123  ,125  ,127  ,128  ,130  ,132  ,134  ,135  ,137  ,
139  ,141  ,143  ,144  ,146  ,148  ,150  ,151  ,153  ,155  ,157  ,158  ,160  ,
162  ,164  ,165  ,167  ,169  ,171  ,173  ,174  ,176  ,178  ,180  ,181  ,183  ,
185  ,187  ,188  ,190  ,192  ,194  ,195  ,197  ,199  ,201  ,202  ,204  ,206  ,
208  ,209  ,211  ,213  ,215  ,216  ,218  ,220  ,222  ,223  ,225  ,227  ,229  ,
230  ,232  ,234  ,236  ,237  ,239  ,241  ,243  ,244  ,246  ,248  ,249  ,251  ,
253  ,255  ,256  ,258  ,260  ,262  ,263  ,265  ,267  ,268  ,270  ,272  ,274  ,
275  ,277  ,279  ,281  ,282  ,284  ,286  ,287  ,289  ,291  ,293  ,294  ,296  ,
298  ,299  ,301  ,303  ,305  ,306  ,308  ,310  ,311  ,313  ,315  ,316  ,318  ,
320  ,322  ,323  ,325  ,327  ,328  ,330  ,332  ,333  ,335  ,337  ,338  ,340  ,
342  ,344  ,345  ,347  ,349  ,350  ,352  ,354  ,355  ,357  ,359  ,360  ,362  ,
364  ,365  ,367  ,369  ,370  ,372  ,374  ,375  ,377  ,379  ,380  ,382  ,384  ,
385  ,387  ,389  ,390  ,392  ,394  ,395  ,397  ,398  ,400  ,402  ,403  ,405  ,
407  ,408  ,410  ,412  ,413  ,415  ,416  ,418  ,420  ,421  ,423  ,425  ,426  ,
428  ,430  ,431  ,433  ,434  ,436  ,438  ,439  ,441  ,442  ,444  ,446  ,447  ,
449  ,450  ,452  ,454  ,455  ,457  ,459  ,460  ,462  ,463  ,465  ,466  ,468  ,
470  ,471  ,473  ,474  ,476  ,478  ,479  ,481  ,482  ,484  ,485  ,487  ,489  ,
490  ,492  ,493  ,495  ,496  ,498  ,500  ,501  ,503  ,504  ,506  ,507  ,509  ,
510  ,512  ,514  ,515  ,517  ,518  ,520  ,521  ,523  ,524  ,526  ,527  ,529  ,
530  ,532  ,534  ,535  ,537  ,538  ,540  ,541  ,543  ,544  ,546  ,547  ,549  ,
550  ,552  ,553  ,555  ,556  ,558  ,559  ,561  ,562  ,564  ,565  ,567  ,568  ,
570  ,571  ,573  ,574  ,576  ,577  ,579  ,580  ,581  ,583  ,584  ,586  ,587  ,
589  ,590  ,592  ,593  ,595  ,596  ,598  ,599  ,600  ,602  ,603  ,605  ,606  ,
608  ,609  ,611  ,612  ,613  ,615  ,616  ,618  ,619  ,621  ,622  ,623  ,625  ,
626  ,628  ,629  ,630  ,632  ,633  ,635  ,636  ,637  ,639  ,640  ,642  ,643  ,
644  ,646  ,647  ,649  ,650  ,651  ,653  ,654  ,655  ,657  ,658  ,660  ,661  ,
662  ,664  ,665  ,666  ,668  ,669  ,670  ,672  ,673  ,674  ,676  ,677  ,679  ,
680  ,681  ,683  ,684  ,685  ,687  ,688  ,689  ,690  ,692  ,693  ,694  ,696  ,
697  ,698  ,700  ,701  ,702  ,704  ,705  ,706  ,707  ,709  ,710  ,711  ,713  ,
714  ,715  ,716  ,718  ,719  ,720  ,722  ,723  ,724  ,725  ,727  ,728  ,729  ,
730  ,732  ,733  ,734  ,735  ,737  ,738  ,739  ,740  ,742  ,743  ,744  ,745  ,
746  ,748  ,749  ,750  ,751  ,753  ,754  ,755  ,756  ,757  ,759  ,760  ,761  ,
762  ,763  ,765  ,766  ,767  ,768  ,769  ,770  ,772  ,773  ,774  ,775  ,776  ,
777  ,779  ,780  ,781  ,782  ,783  ,784  ,786  ,787  ,788  ,789  ,790  ,791  ,
792  ,794  ,795  ,796  ,797  ,798  ,799  ,800  ,801  ,803  ,804  ,805  ,806  ,
807  ,808  ,809  ,810  ,811  ,812  ,813  ,815  ,816  ,817  ,818  ,819  ,820  ,
821  ,822  ,823  ,824  ,825  ,826  ,827  ,828  ,829  ,831  ,832  ,833  ,834  ,
835  ,836  ,837  ,838  ,839  ,840  ,841  ,842  ,843  ,844  ,845  ,846  ,847  ,
848  ,849  ,850  ,851  ,852  ,853  ,854  ,855  ,856  ,857  ,858  ,859  ,860  ,
861  ,862  ,863  ,864  ,865  ,866  ,867  ,867  ,868  ,869  ,870  ,871  ,872  ,
873  ,874  ,875  ,876  ,877  ,878  ,879  ,880  ,880  ,881  ,882  ,883  ,884  ,
885  ,886  ,887  ,888  ,889  ,889  ,890  ,891  ,892  ,893  ,894  ,895  ,896  ,
896  ,897  ,898  ,899  ,900  ,901  ,902  ,902  ,903  ,904  ,905  ,906  ,907  ,
907  ,908  ,909  ,910  ,911  ,912  ,912  ,913  ,914  ,915  ,916  ,916  ,917  ,
918  ,919  ,920  ,920  ,921  ,922  ,923  ,923  ,924  ,925  ,926  ,927  ,927  ,
928  ,929  ,930  ,930  ,931  ,932  ,933  ,933  ,934  ,935  ,935  ,936  ,937  ,
938  ,938  ,939  ,940  ,940  ,941  ,942  ,943  ,943  ,944  ,945  ,945  ,946  ,
947  ,947  ,948  ,949  ,949  ,950  ,951  ,951  ,952  ,953  ,953  ,954  ,955  ,
955  ,956  ,957  ,957  ,958  ,959  ,959  ,960  ,960  ,961  ,962  ,962  ,963  ,
963  ,964  ,965  ,965  ,966  ,966  ,967  ,968  ,968  ,969  ,969  ,970  ,971  ,
971  ,972  ,972  ,973  ,973  ,974  ,974  ,975  ,976  ,976  ,977  ,977  ,978  ,
978  ,979  ,979  ,980  ,980  ,981  ,981  ,982  ,982  ,983  ,983  ,984  ,984  ,
985  ,985  ,986  ,986  ,987  ,987  ,988  ,988  ,989  ,989  ,990  ,990  ,990  ,
991  ,991  ,992  ,992  ,993  ,993  ,994  ,994  ,994  ,995  ,995  ,996  ,996  ,
997  ,997  ,997  ,998  ,998  ,999  ,999  ,999  ,1000 ,1000 ,1000 ,1001 ,1001 ,
1002 ,1002 ,1002 ,1003 ,1003 ,1003 ,1004 ,1004 ,1004 ,1005 ,1005 ,1006 ,1006 ,
1006 ,1007 ,1007 ,1007 ,1007 ,1008 ,1008 ,1008 ,1009 ,1009 ,1009 ,1010 ,1010 ,
1010 ,1011 ,1011 ,1011 ,1011 ,1012 ,1012 ,1012 ,1012 ,1013 ,1013 ,1013 ,1014 ,
1014 ,1014 ,1014 ,1015 ,1015 ,1015 ,1015 ,1015 ,1016 ,1016 ,1016 ,1016 ,1017 ,
1017 ,1017 ,1017 ,1017 ,1018 ,1018 ,1018 ,1018 ,1018 ,1019 ,1019 ,1019 ,1019 ,
1019 ,1019 ,1020 ,1020 ,1020 ,1020 ,1020 ,1020 ,1021 ,1021 ,1021 ,1021 ,1021 ,
1021 ,1021 ,1022 ,1022 ,1022 ,1022 ,1022 ,1022 ,1022 ,1022 ,1022 ,1023 ,1023 ,
1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,1024 ,
1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,
1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,
1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1023 ,1023 ,1023 ,1023 ,1023 ,
1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,1022 ,1022 ,1022 ,1022 ,
1022 ,1022 ,1022 ,1022 ,1022 ,1021 ,1021 ,1021 ,1021 ,1021 ,1021 ,1021 ,1020 ,
1020 ,1020 ,1020 ,1020 ,1020 ,1019 ,1019 ,1019 ,1019 ,1019 ,1019 ,1018 ,1018 ,
1018 ,1018 ,1018 ,1017 ,1017 ,1017 ,1017 ,1017 ,1016 ,1016 ,1016 ,1016 ,1015 ,
1015 ,1015 ,1015 ,1015 ,1014 ,1014 ,1014 ,1014 ,1013 ,1013 ,1013 ,1012 ,1012 ,
1012 ,1012 ,1011 ,1011 ,1011 ,1011 ,1010 ,1010 ,1010 ,1009 ,1009 ,1009 ,1008 ,
1008 ,1008 ,1007 ,1007 ,1007 ,1007 ,1006 ,1006 ,1006 ,1005 ,1005 ,1004 ,1004 ,
1004 ,1003 ,1003 ,1003 ,1002 ,1002 ,1002 ,1001 ,1001 ,1000 ,1000 ,1000 ,999  ,
999  ,999  ,998  ,998  ,997  ,997  ,997  ,996  ,996  ,995  ,995  ,994  ,994  ,
994  ,993  ,993  ,992  ,992  ,991  ,991  ,990  ,990  ,990  ,989  ,989  ,988  ,
988  ,987  ,987  ,986  ,986  ,985  ,985  ,984  ,984  ,983  ,983  ,982  ,982  ,
981  ,981  ,980  ,980  ,979  ,979  ,978  ,978  ,977  ,977  ,976  ,976  ,975  ,
974  ,974  ,973  ,973  ,972  ,972  ,971  ,971  ,970  ,969  ,969  ,968  ,968  ,
967  ,966  ,966  ,965  ,965  ,964  ,963  ,963  ,962  ,962  ,961  ,960  ,960  ,
959  ,959  ,958  ,957  ,957  ,956  ,955  ,955  ,954  ,953  ,953  ,952  ,951  ,
951  ,950  ,949  ,949  ,948  ,947  ,947  ,946  ,945  ,945  ,944  ,943  ,943  ,
942  ,941  ,940  ,940  ,939  ,938  ,938  ,937  ,936  ,935  ,935  ,934  ,933  ,
933  ,932  ,931  ,930  ,930  ,929  ,928  ,927  ,927  ,926  ,925  ,924  ,923  ,
923  ,922  ,921  ,920  ,920  ,919  ,918  ,917  ,916  ,916  ,915  ,914  ,913  ,
912  ,912  ,911  ,910  ,909  ,908  ,907  ,907  ,906  ,905  ,904  ,903  ,902  ,
902  ,901  ,900  ,899  ,898  ,897  ,896  ,896  ,895  ,894  ,893  ,892  ,891  ,
890  ,889  ,889  ,888  ,887  ,886  ,885  ,884  ,883  ,882  ,881  ,880  ,880  ,
879  ,878  ,877  ,876  ,875  ,874  ,873  ,872  ,871  ,870  ,869  ,868  ,867  ,
867  ,866  ,865  ,864  ,863  ,862  ,861  ,860  ,859  ,858  ,857  ,856  ,855  ,
854  ,853  ,852  ,851  ,850  ,849  ,848  ,847  ,846  ,845  ,844  ,843  ,842  ,
841  ,840  ,839  ,838  ,837  ,836  ,835  ,834  ,833  ,832  ,831  ,829  ,828  ,
827  ,826  ,825  ,824  ,823  ,822  ,821  ,820  ,819  ,818  ,817  ,816  ,815  ,
813  ,812  ,811  ,810  ,809  ,808  ,807  ,806  ,805  ,804  ,803  ,801  ,800  ,
799  ,798  ,797  ,796  ,795  ,794  ,792  ,791  ,790  ,789  ,788  ,787  ,786  ,
784  ,783  ,782  ,781  ,780  ,779  ,777  ,776  ,775  ,774  ,773  ,772  ,770  ,
769  ,768  ,767  ,766  ,765  ,763  ,762  ,761  ,760  ,759  ,757  ,756  ,755  ,
754  ,753  ,751  ,750  ,749  ,748  ,746  ,745  ,744  ,743  ,742  ,740  ,739  ,
738  ,737  ,735  ,734  ,733  ,732  ,730  ,729  ,728  ,727  ,725  ,724  ,723  ,
722  ,720  ,719  ,718  ,716  ,715  ,714  ,713  ,711  ,710  ,709  ,707  ,706  ,
705  ,704  ,702  ,701  ,700  ,698  ,697  ,696  ,694  ,693  ,692  ,690  ,689  ,
688  ,687  ,685  ,684  ,683  ,681  ,680  ,679  ,677  ,676  ,674  ,673  ,672  ,
670  ,669  ,668  ,666  ,665  ,664  ,662  ,661  ,660  ,658  ,657  ,655  ,654  ,
653  ,651  ,650  ,649  ,647  ,646  ,644  ,643  ,642  ,640  ,639  ,637  ,636  ,
635  ,633  ,632  ,630  ,629  ,628  ,626  ,625  ,623  ,622  ,621  ,619  ,618  ,
616  ,615  ,613  ,612  ,611  ,609  ,608  ,606  ,605  ,603  ,602  ,600  ,599  ,
598  ,596  ,595  ,593  ,592  ,590  ,589  ,587  ,586  ,584  ,583  ,581  ,580  ,
579  ,577  ,576  ,574  ,573  ,571  ,570  ,568  ,567  ,565  ,564  ,562  ,561  ,
559  ,558  ,556  ,555  ,553  ,552  ,550  ,549  ,547  ,546  ,544  ,543  ,541  ,
540  ,538  ,537  ,535  ,534  ,532  ,530  ,529  ,527  ,526  ,524  ,523  ,521  ,
520  ,518  ,517  ,515  ,514  ,512  ,510  ,509  ,507  ,506  ,504  ,503  ,501  ,
500  ,498  ,496  ,495  ,493  ,492  ,490  ,489  ,487  ,485  ,484  ,482  ,481  ,
479  ,478  ,476  ,474  ,473  ,471  ,470  ,468  ,466  ,465  ,463  ,462  ,460  ,
459  ,457  ,455  ,454  ,452  ,450  ,449  ,447  ,446  ,444  ,442  ,441  ,439  ,
438  ,436  ,434  ,433  ,431  ,430  ,428  ,426  ,425  ,423  ,421  ,420  ,418  ,
416  ,415  ,413  ,412  ,410  ,408  ,407  ,405  ,403  ,402  ,400  ,398  ,397  ,
395  ,394  ,392  ,390  ,389  ,387  ,385  ,384  ,382  ,380  ,379  ,377  ,375  ,
374  ,372  ,370  ,369  ,367  ,365  ,364  ,362  ,360  ,359  ,357  ,355  ,354  ,
352  ,350  ,349  ,347  ,345  ,344  ,342  ,340  ,338  ,337  ,335  ,333  ,332  ,
330  ,328  ,327  ,325  ,323  ,322  ,320  ,318  ,316  ,315  ,313  ,311  ,310  ,
308  ,306  ,305  ,303  ,301  ,299  ,298  ,296  ,294  ,293  ,291  ,289  ,287  ,
286  ,284  ,282  ,281  ,279  ,277  ,275  ,274  ,272  ,270  ,268  ,267  ,265  ,
263  ,262  ,260  ,258  ,256  ,255  ,253  ,251  ,249  ,248  ,246  ,244  ,243  ,
241  ,239  ,237  ,236  ,234  ,232  ,230  ,229  ,227  ,225  ,223  ,222  ,220  ,
218  ,216  ,215  ,213  ,211  ,209  ,208  ,206  ,204  ,202  ,201  ,199  ,197  ,
195  ,194  ,192  ,190  ,188  ,187  ,185  ,183  ,181  ,180  ,178  ,176  ,174  ,
173  ,171  ,169  ,167  ,165  ,164  ,162  ,160  ,158  ,157  ,155  ,153  ,151  ,
150  ,148  ,146  ,144  ,143  ,141  ,139  ,137  ,135  ,134  ,132  ,130  ,128  ,
127  ,125  ,123  ,121  ,119  ,118  ,116  ,114  ,112  ,111  ,109  ,107  ,105  ,
103  ,102  ,100  ,98   ,96   ,95   ,93   ,91   ,89   ,87   ,86   ,84   ,82   ,
80   ,79   ,77   ,75   ,73   ,71   ,70   ,68   ,66   ,64   ,63   ,61   ,59   ,
57   ,55   ,54   ,52   ,50   ,48   ,46   ,45   ,43   ,41   ,39   ,38   ,36   ,
34   ,32   ,30   ,29   ,27   ,25   ,23   ,21   ,20   ,18   ,16   ,14   ,13   ,
11   ,9    ,7    ,5    ,4    ,2    ,0    ,-2   ,-4   ,-5   ,-7   ,-9   ,-11  ,
-13  ,-14  ,-16  ,-18  ,-20  ,-21  ,-23  ,-25  ,-27  ,-29  ,-30  ,-32  ,-34  ,
-36  ,-38  ,-39  ,-41  ,-43  ,-45  ,-46  ,-48  ,-50  ,-52  ,-54  ,-55  ,-57  ,
-59  ,-61  ,-63  ,-64  ,-66  ,-68  ,-70  ,-71  ,-73  ,-75  ,-77  ,-79  ,-80  ,
-82  ,-84  ,-86  ,-87  ,-89  ,-91  ,-93  ,-95  ,-96  ,-98  ,-100 ,-102 ,-103 ,
-105 ,-107 ,-109 ,-111 ,-112 ,-114 ,-116 ,-118 ,-119 ,-121 ,-123 ,-125 ,-127 ,
-128 ,-130 ,-132 ,-134 ,-135 ,-137 ,-139 ,-141 ,-143 ,-144 ,-146 ,-148 ,-150 ,
-151 ,-153 ,-155 ,-157 ,-158 ,-160 ,-162 ,-164 ,-165 ,-167 ,-169 ,-171 ,-173 ,
-174 ,-176 ,-178 ,-180 ,-181 ,-183 ,-185 ,-187 ,-188 ,-190 ,-192 ,-194 ,-195 ,
-197 ,-199 ,-201 ,-202 ,-204 ,-206 ,-208 ,-209 ,-211 ,-213 ,-215 ,-216 ,-218 ,
-220 ,-222 ,-223 ,-225 ,-227 ,-229 ,-230 ,-232 ,-234 ,-236 ,-237 ,-239 ,-241 ,
-243 ,-244 ,-246 ,-248 ,-249 ,-251 ,-253 ,-255 ,-256 ,-258 ,-260 ,-262 ,-263 ,
-265 ,-267 ,-268 ,-270 ,-272 ,-274 ,-275 ,-277 ,-279 ,-281 ,-282 ,-284 ,-286 ,
-287 ,-289 ,-291 ,-293 ,-294 ,-296 ,-298 ,-299 ,-301 ,-303 ,-305 ,-306 ,-308 ,
-310 ,-311 ,-313 ,-315 ,-316 ,-318 ,-320 ,-322 ,-323 ,-325 ,-327 ,-328 ,-330 ,
-332 ,-333 ,-335 ,-337 ,-338 ,-340 ,-342 ,-344 ,-345 ,-347 ,-349 ,-350 ,-352 ,
-354 ,-355 ,-357 ,-359 ,-360 ,-362 ,-364 ,-365 ,-367 ,-369 ,-370 ,-372 ,-374 ,
-375 ,-377 ,-379 ,-380 ,-382 ,-384 ,-385 ,-387 ,-389 ,-390 ,-392 ,-394 ,-395 ,
-397 ,-398 ,-400 ,-402 ,-403 ,-405 ,-407 ,-408 ,-410 ,-412 ,-413 ,-415 ,-416 ,
-418 ,-420 ,-421 ,-423 ,-425 ,-426 ,-428 ,-430 ,-431 ,-433 ,-434 ,-436 ,-438 ,
-439 ,-441 ,-442 ,-444 ,-446 ,-447 ,-449 ,-450 ,-452 ,-454 ,-455 ,-457 ,-459 ,
-460 ,-462 ,-463 ,-465 ,-466 ,-468 ,-470 ,-471 ,-473 ,-474 ,-476 ,-478 ,-479 ,
-481 ,-482 ,-484 ,-485 ,-487 ,-489 ,-490 ,-492 ,-493 ,-495 ,-496 ,-498 ,-500 ,
-501 ,-503 ,-504 ,-506 ,-507 ,-509 ,-510 ,-512 ,-514 ,-515 ,-517 ,-518 ,-520 ,
-521 ,-523 ,-524 ,-526 ,-527 ,-529 ,-530 ,-532 ,-534 ,-535 ,-537 ,-538 ,-540 ,
-541 ,-543 ,-544 ,-546 ,-547 ,-549 ,-550 ,-552 ,-553 ,-555 ,-556 ,-558 ,-559 ,
-561 ,-562 ,-564 ,-565 ,-567 ,-568 ,-570 ,-571 ,-573 ,-574 ,-576 ,-577 ,-579 ,
-580 ,-581 ,-583 ,-584 ,-586 ,-587 ,-589 ,-590 ,-592 ,-593 ,-595 ,-596 ,-598 ,
-599 ,-600 ,-602 ,-603 ,-605 ,-606 ,-608 ,-609 ,-611 ,-612 ,-613 ,-615 ,-616 ,
-618 ,-619 ,-621 ,-622 ,-623 ,-625 ,-626 ,-628 ,-629 ,-630 ,-632 ,-633 ,-635 ,
-636 ,-637 ,-639 ,-640 ,-642 ,-643 ,-644 ,-646 ,-647 ,-649 ,-650 ,-651 ,-653 ,
-654 ,-655 ,-657 ,-658 ,-660 ,-661 ,-662 ,-664 ,-665 ,-666 ,-668 ,-669 ,-670 ,
-672 ,-673 ,-674 ,-676 ,-677 ,-679 ,-680 ,-681 ,-683 ,-684 ,-685 ,-687 ,-688 ,
-689 ,-690 ,-692 ,-693 ,-694 ,-696 ,-697 ,-698 ,-700 ,-701 ,-702 ,-704 ,-705 ,
-706 ,-707 ,-709 ,-710 ,-711 ,-713 ,-714 ,-715 ,-716 ,-718 ,-719 ,-720 ,-722 ,
-723 ,-724 ,-725 ,-727 ,-728 ,-729 ,-730 ,-732 ,-733 ,-734 ,-735 ,-737 ,-738 ,
-739 ,-740 ,-742 ,-743 ,-744 ,-745 ,-746 ,-748 ,-749 ,-750 ,-751 ,-753 ,-754 ,
-755 ,-756 ,-757 ,-759 ,-760 ,-761 ,-762 ,-763 ,-765 ,-766 ,-767 ,-768 ,-769 ,
-770 ,-772 ,-773 ,-774 ,-775 ,-776 ,-777 ,-779 ,-780 ,-781 ,-782 ,-783 ,-784 ,
-786 ,-787 ,-788 ,-789 ,-790 ,-791 ,-792 ,-794 ,-795 ,-796 ,-797 ,-798 ,-799 ,
-800 ,-801 ,-803 ,-804 ,-805 ,-806 ,-807 ,-808 ,-809 ,-810 ,-811 ,-812 ,-813 ,
-815 ,-816 ,-817 ,-818 ,-819 ,-820 ,-821 ,-822 ,-823 ,-824 ,-825 ,-826 ,-827 ,
-828 ,-829 ,-831 ,-832 ,-833 ,-834 ,-835 ,-836 ,-837 ,-838 ,-839 ,-840 ,-841 ,
-842 ,-843 ,-844 ,-845 ,-846 ,-847 ,-848 ,-849 ,-850 ,-851 ,-852 ,-853 ,-854 ,
-855 ,-856 ,-857 ,-858 ,-859 ,-860 ,-861 ,-862 ,-863 ,-864 ,-865 ,-866 ,-867 ,
-867 ,-868 ,-869 ,-870 ,-871 ,-872 ,-873 ,-874 ,-875 ,-876 ,-877 ,-878 ,-879 ,
-880 ,-880 ,-881 ,-882 ,-883 ,-884 ,-885 ,-886 ,-887 ,-888 ,-889 ,-889 ,-890 ,
-891 ,-892 ,-893 ,-894 ,-895 ,-896 ,-896 ,-897 ,-898 ,-899 ,-900 ,-901 ,-902 ,
-902 ,-903 ,-904 ,-905 ,-906 ,-907 ,-907 ,-908 ,-909 ,-910 ,-911 ,-912 ,-912 ,
-913 ,-914 ,-915 ,-916 ,-916 ,-917 ,-918 ,-919 ,-920 ,-920 ,-921 ,-922 ,-923 ,
-923 ,-924 ,-925 ,-926 ,-927 ,-927 ,-928 ,-929 ,-930 ,-930 ,-931 ,-932 ,-933 ,
-933 ,-934 ,-935 ,-935 ,-936 ,-937 ,-938 ,-938 ,-939 ,-940 ,-940 ,-941 ,-942 ,
-943 ,-943 ,-944 ,-945 ,-945 ,-946 ,-947 ,-947 ,-948 ,-949 ,-949 ,-950 ,-951 ,
-951 ,-952 ,-953 ,-953 ,-954 ,-955 ,-955 ,-956 ,-957 ,-957 ,-958 ,-959 ,-959 ,
-960 ,-960 ,-961 ,-962 ,-962 ,-963 ,-963 ,-964 ,-965 ,-965 ,-966 ,-966 ,-967 ,
-968 ,-968 ,-969 ,-969 ,-970 ,-971 ,-971 ,-972 ,-972 ,-973 ,-973 ,-974 ,-974 ,
-975 ,-976 ,-976 ,-977 ,-977 ,-978 ,-978 ,-979 ,-979 ,-980 ,-980 ,-981 ,-981 ,
-982 ,-982 ,-983 ,-983 ,-984 ,-984 ,-985 ,-985 ,-986 ,-986 ,-987 ,-987 ,-988 ,
-988 ,-989 ,-989 ,-990 ,-990 ,-990 ,-991 ,-991 ,-992 ,-992 ,-993 ,-993 ,-994 ,
-994 ,-994 ,-995 ,-995 ,-996 ,-996 ,-997 ,-997 ,-997 ,-998 ,-998 ,-999 ,-999 ,
-999 ,-1000,-1000,-1000,-1001,-1001,-1002,-1002,-1002,-1003,-1003,-1003,-1004,
-1004,-1004,-1005,-1005,-1006,-1006,-1006,-1007,-1007,-1007,-1007,-1008,-1008,
-1008,-1009,-1009,-1009,-1010,-1010,-1010,-1011,-1011,-1011,-1011,-1012,-1012,
-1012,-1012,-1013,-1013,-1013,-1014,-1014,-1014,-1014,-1015,-1015,-1015,-1015,
-1015,-1016,-1016,-1016,-1016,-1017,-1017,-1017,-1017,-1017,-1018,-1018,-1018,
-1018,-1018,-1019,-1019,-1019,-1019,-1019,-1019,-1020,-1020,-1020,-1020,-1020,
-1020,-1021,-1021,-1021,-1021,-1021,-1021,-1021,-1022,-1022,-1022,-1022,-1022,
-1022,-1022,-1022,-1022,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,
-1023,-1023,-1023,-1023,-1023,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,
-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,
-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,
-1024,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,
-1023,-1023,-1022,-1022,-1022,-1022,-1022,-1022,-1022,-1022,-1022,-1021,-1021,
-1021,-1021,-1021,-1021,-1021,-1020,-1020,-1020,-1020,-1020,-1020,-1019,-1019,
-1019,-1019,-1019,-1019,-1018,-1018,-1018,-1018,-1018,-1017,-1017,-1017,-1017,
-1017,-1016,-1016,-1016,-1016,-1015,-1015,-1015,-1015,-1015,-1014,-1014,-1014,
-1014,-1013,-1013,-1013,-1012,-1012,-1012,-1012,-1011,-1011,-1011,-1011,-1010,
-1010,-1010,-1009,-1009,-1009,-1008,-1008,-1008,-1007,-1007,-1007,-1007,-1006,
-1006,-1006,-1005,-1005,-1004,-1004,-1004,-1003,-1003,-1003,-1002,-1002,-1002,
-1001,-1001,-1000,-1000,-1000,-999 ,-999 ,-999 ,-998 ,-998 ,-997 ,-997 ,-997 ,
-996 ,-996 ,-995 ,-995 ,-994 ,-994 ,-994 ,-993 ,-993 ,-992 ,-992 ,-991 ,-991 ,
-990 ,-990 ,-990 ,-989 ,-989 ,-988 ,-988 ,-987 ,-987 ,-986 ,-986 ,-985 ,-985 ,
-984 ,-984 ,-983 ,-983 ,-982 ,-982 ,-981 ,-981 ,-980 ,-980 ,-979 ,-979 ,-978 ,
-978 ,-977 ,-977 ,-976 ,-976 ,-975 ,-974 ,-974 ,-973 ,-973 ,-972 ,-972 ,-971 ,
-971 ,-970 ,-969 ,-969 ,-968 ,-968 ,-967 ,-966 ,-966 ,-965 ,-965 ,-964 ,-963 ,
-963 ,-962 ,-962 ,-961 ,-960 ,-960 ,-959 ,-959 ,-958 ,-957 ,-957 ,-956 ,-955 ,
-955 ,-954 ,-953 ,-953 ,-952 ,-951 ,-951 ,-950 ,-949 ,-949 ,-948 ,-947 ,-947 ,
-946 ,-945 ,-945 ,-944 ,-943 ,-943 ,-942 ,-941 ,-940 ,-940 ,-939 ,-938 ,-938 ,
-937 ,-936 ,-935 ,-935 ,-934 ,-933 ,-933 ,-932 ,-931 ,-930 ,-930 ,-929 ,-928 ,
-927 ,-927 ,-926 ,-925 ,-924 ,-923 ,-923 ,-922 ,-921 ,-920 ,-920 ,-919 ,-918 ,
-917 ,-916 ,-916 ,-915 ,-914 ,-913 ,-912 ,-912 ,-911 ,-910 ,-909 ,-908 ,-907 ,
-907 ,-906 ,-905 ,-904 ,-903 ,-902 ,-902 ,-901 ,-900 ,-899 ,-898 ,-897 ,-896 ,
-896 ,-895 ,-894 ,-893 ,-892 ,-891 ,-890 ,-889 ,-889 ,-888 ,-887 ,-886 ,-885 ,
-884 ,-883 ,-882 ,-881 ,-880 ,-880 ,-879 ,-878 ,-877 ,-876 ,-875 ,-874 ,-873 ,
-872 ,-871 ,-870 ,-869 ,-868 ,-867 ,-867 ,-866 ,-865 ,-864 ,-863 ,-862 ,-861 ,
-860 ,-859 ,-858 ,-857 ,-856 ,-855 ,-854 ,-853 ,-852 ,-851 ,-850 ,-849 ,-848 ,
-847 ,-846 ,-845 ,-844 ,-843 ,-842 ,-841 ,-840 ,-839 ,-838 ,-837 ,-836 ,-835 ,
-834 ,-833 ,-832 ,-831 ,-829 ,-828 ,-827 ,-826 ,-825 ,-824 ,-823 ,-822 ,-821 ,
-820 ,-819 ,-818 ,-817 ,-816 ,-815 ,-813 ,-812 ,-811 ,-810 ,-809 ,-808 ,-807 ,
-806 ,-805 ,-804 ,-803 ,-801 ,-800 ,-799 ,-798 ,-797 ,-796 ,-795 ,-794 ,-792 ,
-791 ,-790 ,-789 ,-788 ,-787 ,-786 ,-784 ,-783 ,-782 ,-781 ,-780 ,-779 ,-777 ,
-776 ,-775 ,-774 ,-773 ,-772 ,-770 ,-769 ,-768 ,-767 ,-766 ,-765 ,-763 ,-762 ,
-761 ,-760 ,-759 ,-757 ,-756 ,-755 ,-754 ,-753 ,-751 ,-750 ,-749 ,-748 ,-746 ,
-745 ,-744 ,-743 ,-742 ,-740 ,-739 ,-738 ,-737 ,-735 ,-734 ,-733 ,-732 ,-730 ,
-729 ,-728 ,-727 ,-725 ,-724 ,-723 ,-722 ,-720 ,-719 ,-718 ,-716 ,-715 ,-714 ,
-713 ,-711 ,-710 ,-709 ,-707 ,-706 ,-705 ,-704 ,-702 ,-701 ,-700 ,-698 ,-697 ,
-696 ,-694 ,-693 ,-692 ,-690 ,-689 ,-688 ,-687 ,-685 ,-684 ,-683 ,-681 ,-680 ,
-679 ,-677 ,-676 ,-674 ,-673 ,-672 ,-670 ,-669 ,-668 ,-666 ,-665 ,-664 ,-662 ,
-661 ,-660 ,-658 ,-657 ,-655 ,-654 ,-653 ,-651 ,-650 ,-649 ,-647 ,-646 ,-644 ,
-643 ,-642 ,-640 ,-639 ,-637 ,-636 ,-635 ,-633 ,-632 ,-630 ,-629 ,-628 ,-626 ,
-625 ,-623 ,-622 ,-621 ,-619 ,-618 ,-616 ,-615 ,-613 ,-612 ,-611 ,-609 ,-608 ,
-606 ,-605 ,-603 ,-602 ,-600 ,-599 ,-598 ,-596 ,-595 ,-593 ,-592 ,-590 ,-589 ,
-587 ,-586 ,-584 ,-583 ,-581 ,-580 ,-579 ,-577 ,-576 ,-574 ,-573 ,-571 ,-570 ,
-568 ,-567 ,-565 ,-564 ,-562 ,-561 ,-559 ,-558 ,-556 ,-555 ,-553 ,-552 ,-550 ,
-549 ,-547 ,-546 ,-544 ,-543 ,-541 ,-540 ,-538 ,-537 ,-535 ,-534 ,-532 ,-530 ,
-529 ,-527 ,-526 ,-524 ,-523 ,-521 ,-520 ,-518 ,-517 ,-515 ,-514 ,-512 ,-510 ,
-509 ,-507 ,-506 ,-504 ,-503 ,-501 ,-500 ,-498 ,-496 ,-495 ,-493 ,-492 ,-490 ,
-489 ,-487 ,-485 ,-484 ,-482 ,-481 ,-479 ,-478 ,-476 ,-474 ,-473 ,-471 ,-470 ,
-468 ,-466 ,-465 ,-463 ,-462 ,-460 ,-459 ,-457 ,-455 ,-454 ,-452 ,-450 ,-449 ,
-447 ,-446 ,-444 ,-442 ,-441 ,-439 ,-438 ,-436 ,-434 ,-433 ,-431 ,-430 ,-428 ,
-426 ,-425 ,-423 ,-421 ,-420 ,-418 ,-416 ,-415 ,-413 ,-412 ,-410 ,-408 ,-407 ,
-405 ,-403 ,-402 ,-400 ,-398 ,-397 ,-395 ,-394 ,-392 ,-390 ,-389 ,-387 ,-385 ,
-384 ,-382 ,-380 ,-379 ,-377 ,-375 ,-374 ,-372 ,-370 ,-369 ,-367 ,-365 ,-364 ,
-362 ,-360 ,-359 ,-357 ,-355 ,-354 ,-352 ,-350 ,-349 ,-347 ,-345 ,-344 ,-342 ,
-340 ,-338 ,-337 ,-335 ,-333 ,-332 ,-330 ,-328 ,-327 ,-325 ,-323 ,-322 ,-320 ,
-318 ,-316 ,-315 ,-313 ,-311 ,-310 ,-308 ,-306 ,-305 ,-303 ,-301 ,-299 ,-298 ,
-296 ,-294 ,-293 ,-291 ,-289 ,-287 ,-286 ,-284 ,-282 ,-281 ,-279 ,-277 ,-275 ,
-274 ,-272 ,-270 ,-268 ,-267 ,-265 ,-263 ,-262 ,-260 ,-258 ,-256 ,-255 ,-253 ,
-251 ,-249 ,-248 ,-246 ,-244 ,-243 ,-241 ,-239 ,-237 ,-236 ,-234 ,-232 ,-230 ,
-229 ,-227 ,-225 ,-223 ,-222 ,-220 ,-218 ,-216 ,-215 ,-213 ,-211 ,-209 ,-208 ,
-206 ,-204 ,-202 ,-201 ,-199 ,-197 ,-195 ,-194 ,-192 ,-190 ,-188 ,-187 ,-185 ,
-183 ,-181 ,-180 ,-178 ,-176 ,-174 ,-173 ,-171 ,-169 ,-167 ,-165 ,-164 ,-162 ,
-160 ,-158 ,-157 ,-155 ,-153 ,-151 ,-150 ,-148 ,-146 ,-144 ,-143 ,-141 ,-139 ,
-137 ,-135 ,-134 ,-132 ,-130 ,-128 ,-127 ,-125 ,-123 ,-121 ,-119 ,-118 ,-116 ,
-114 ,-112 ,-111 ,-109 ,-107 ,-105 ,-103 ,-102 ,-100 ,-98  ,-96  ,-95  ,-93  ,
-91  ,-89  ,-87  ,-86  ,-84  ,-82  ,-80  ,-79  ,-77  ,-75  ,-73  ,-71  ,-70  ,
-68  ,-66  ,-64  ,-63  ,-61  ,-59  ,-57  ,-55  ,-54  ,-52  ,-50  ,-48  ,-46  ,
-45  ,-43  ,-41  ,-39  ,-38  ,-36  ,-34  ,-32  ,-30  ,-29  ,-27  ,-25  ,-23  ,
-21  ,-20  ,-18  ,-16  ,-14  ,-13  ,-11  ,-9   ,-7   ,-5   ,-4   ,-2   ,0    ,
	
};

int Cos[] =	//	0 to 360.0
{
	1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,
	1024 ,1024 ,1024 ,1024 ,1024 ,1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,
	1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,1022 ,1022 ,1022 ,1022 ,1022 ,1022 ,1022 ,
	1022 ,1022 ,1021 ,1021 ,1021 ,1021 ,1021 ,1021 ,1021 ,1020 ,1020 ,1020 ,1020 ,
	1020 ,1020 ,1019 ,1019 ,1019 ,1019 ,1019 ,1019 ,1018 ,1018 ,1018 ,1018 ,1018 ,
	1017 ,1017 ,1017 ,1017 ,1017 ,1016 ,1016 ,1016 ,1016 ,1015 ,1015 ,1015 ,1015 ,
	1015 ,1014 ,1014 ,1014 ,1014 ,1013 ,1013 ,1013 ,1012 ,1012 ,1012 ,1012 ,1011 ,
	1011 ,1011 ,1011 ,1010 ,1010 ,1010 ,1009 ,1009 ,1009 ,1008 ,1008 ,1008 ,1007 ,
	1007 ,1007 ,1007 ,1006 ,1006 ,1006 ,1005 ,1005 ,1004 ,1004 ,1004 ,1003 ,1003 ,
	1003 ,1002 ,1002 ,1002 ,1001 ,1001 ,1000 ,1000 ,1000 ,999  ,999  ,999  ,998  ,
	998  ,997  ,997  ,997  ,996  ,996  ,995  ,995  ,994  ,994  ,994  ,993  ,993  ,
	992  ,992  ,991  ,991  ,990  ,990  ,990  ,989  ,989  ,988  ,988  ,987  ,987  ,
	986  ,986  ,985  ,985  ,984  ,984  ,983  ,983  ,982  ,982  ,981  ,981  ,980  ,
	980  ,979  ,979  ,978  ,978  ,977  ,977  ,976  ,976  ,975  ,974  ,974  ,973  ,
	973  ,972  ,972  ,971  ,971  ,970  ,969  ,969  ,968  ,968  ,967  ,966  ,966  ,
	965  ,965  ,964  ,963  ,963  ,962  ,962  ,961  ,960  ,960  ,959  ,959  ,958  ,
	957  ,957  ,956  ,955  ,955  ,954  ,953  ,953  ,952  ,951  ,951  ,950  ,949  ,
	949  ,948  ,947  ,947  ,946  ,945  ,945  ,944  ,943  ,943  ,942  ,941  ,940  ,
	940  ,939  ,938  ,938  ,937  ,936  ,935  ,935  ,934  ,933  ,933  ,932  ,931  ,
	930  ,930  ,929  ,928  ,927  ,927  ,926  ,925  ,924  ,923  ,923  ,922  ,921  ,
	920  ,920  ,919  ,918  ,917  ,916  ,916  ,915  ,914  ,913  ,912  ,912  ,911  ,
	910  ,909  ,908  ,907  ,907  ,906  ,905  ,904  ,903  ,902  ,902  ,901  ,900  ,
	899  ,898  ,897  ,896  ,896  ,895  ,894  ,893  ,892  ,891  ,890  ,889  ,889  ,
	888  ,887  ,886  ,885  ,884  ,883  ,882  ,881  ,880  ,880  ,879  ,878  ,877  ,
	876  ,875  ,874  ,873  ,872  ,871  ,870  ,869  ,868  ,867  ,867  ,866  ,865  ,
	864  ,863  ,862  ,861  ,860  ,859  ,858  ,857  ,856  ,855  ,854  ,853  ,852  ,
	851  ,850  ,849  ,848  ,847  ,846  ,845  ,844  ,843  ,842  ,841  ,840  ,839  ,
	838  ,837  ,836  ,835  ,834  ,833  ,832  ,831  ,829  ,828  ,827  ,826  ,825  ,
	824  ,823  ,822  ,821  ,820  ,819  ,818  ,817  ,816  ,815  ,813  ,812  ,811  ,
	810  ,809  ,808  ,807  ,806  ,805  ,804  ,803  ,801  ,800  ,799  ,798  ,797  ,
	796  ,795  ,794  ,792  ,791  ,790  ,789  ,788  ,787  ,786  ,784  ,783  ,782  ,
	781  ,780  ,779  ,777  ,776  ,775  ,774  ,773  ,772  ,770  ,769  ,768  ,767  ,
	766  ,765  ,763  ,762  ,761  ,760  ,759  ,757  ,756  ,755  ,754  ,753  ,751  ,
	750  ,749  ,748  ,746  ,745  ,744  ,743  ,742  ,740  ,739  ,738  ,737  ,735  ,
	734  ,733  ,732  ,730  ,729  ,728  ,727  ,725  ,724  ,723  ,722  ,720  ,719  ,
	718  ,716  ,715  ,714  ,713  ,711  ,710  ,709  ,707  ,706  ,705  ,704  ,702  ,
	701  ,700  ,698  ,697  ,696  ,694  ,693  ,692  ,690  ,689  ,688  ,687  ,685  ,
	684  ,683  ,681  ,680  ,679  ,677  ,676  ,674  ,673  ,672  ,670  ,669  ,668  ,
	666  ,665  ,664  ,662  ,661  ,660  ,658  ,657  ,655  ,654  ,653  ,651  ,650  ,
	649  ,647  ,646  ,644  ,643  ,642  ,640  ,639  ,637  ,636  ,635  ,633  ,632  ,
	630  ,629  ,628  ,626  ,625  ,623  ,622  ,621  ,619  ,618  ,616  ,615  ,613  ,
	612  ,611  ,609  ,608  ,606  ,605  ,603  ,602  ,600  ,599  ,598  ,596  ,595  ,
	593  ,592  ,590  ,589  ,587  ,586  ,584  ,583  ,581  ,580  ,579  ,577  ,576  ,
	574  ,573  ,571  ,570  ,568  ,567  ,565  ,564  ,562  ,561  ,559  ,558  ,556  ,
	555  ,553  ,552  ,550  ,549  ,547  ,546  ,544  ,543  ,541  ,540  ,538  ,537  ,
	535  ,534  ,532  ,530  ,529  ,527  ,526  ,524  ,523  ,521  ,520  ,518  ,517  ,
	515  ,514  ,512  ,510  ,509  ,507  ,506  ,504  ,503  ,501  ,500  ,498  ,496  ,
	495  ,493  ,492  ,490  ,489  ,487  ,485  ,484  ,482  ,481  ,479  ,478  ,476  ,
	474  ,473  ,471  ,470  ,468  ,466  ,465  ,463  ,462  ,460  ,459  ,457  ,455  ,
	454  ,452  ,450  ,449  ,447  ,446  ,444  ,442  ,441  ,439  ,438  ,436  ,434  ,
	433  ,431  ,430  ,428  ,426  ,425  ,423  ,421  ,420  ,418  ,416  ,415  ,413  ,
	412  ,410  ,408  ,407  ,405  ,403  ,402  ,400  ,398  ,397  ,395  ,394  ,392  ,
	390  ,389  ,387  ,385  ,384  ,382  ,380  ,379  ,377  ,375  ,374  ,372  ,370  ,
	369  ,367  ,365  ,364  ,362  ,360  ,359  ,357  ,355  ,354  ,352  ,350  ,349  ,
	347  ,345  ,344  ,342  ,340  ,338  ,337  ,335  ,333  ,332  ,330  ,328  ,327  ,
	325  ,323  ,322  ,320  ,318  ,316  ,315  ,313  ,311  ,310  ,308  ,306  ,305  ,
	303  ,301  ,299  ,298  ,296  ,294  ,293  ,291  ,289  ,287  ,286  ,284  ,282  ,
	281  ,279  ,277  ,275  ,274  ,272  ,270  ,268  ,267  ,265  ,263  ,262  ,260  ,
	258  ,256  ,255  ,253  ,251  ,249  ,248  ,246  ,244  ,243  ,241  ,239  ,237  ,
	236  ,234  ,232  ,230  ,229  ,227  ,225  ,223  ,222  ,220  ,218  ,216  ,215  ,
	213  ,211  ,209  ,208  ,206  ,204  ,202  ,201  ,199  ,197  ,195  ,194  ,192  ,
	190  ,188  ,187  ,185  ,183  ,181  ,180  ,178  ,176  ,174  ,173  ,171  ,169  ,
	167  ,165  ,164  ,162  ,160  ,158  ,157  ,155  ,153  ,151  ,150  ,148  ,146  ,
	144  ,143  ,141  ,139  ,137  ,135  ,134  ,132  ,130  ,128  ,127  ,125  ,123  ,
	121  ,119  ,118  ,116  ,114  ,112  ,111  ,109  ,107  ,105  ,103  ,102  ,100  ,
	98   ,96   ,95   ,93   ,91   ,89   ,87   ,86   ,84   ,82   ,80   ,79   ,77   ,
	75   ,73   ,71   ,70   ,68   ,66   ,64   ,63   ,61   ,59   ,57   ,55   ,54   ,
	52   ,50   ,48   ,46   ,45   ,43   ,41   ,39   ,38   ,36   ,34   ,32   ,30   ,
	29   ,27   ,25   ,23   ,21   ,20   ,18   ,16   ,14   ,13   ,11   ,9    ,7    ,
	5    ,4    ,2    ,0    ,-2   ,-4   ,-5   ,-7   ,-9   ,-11  ,-13  ,-14  ,-16  ,
	-18  ,-20  ,-21  ,-23  ,-25  ,-27  ,-29  ,-30  ,-32  ,-34  ,-36  ,-38  ,-39  ,
	-41  ,-43  ,-45  ,-46  ,-48  ,-50  ,-52  ,-54  ,-55  ,-57  ,-59  ,-61  ,-63  ,
	-64  ,-66  ,-68  ,-70  ,-71  ,-73  ,-75  ,-77  ,-79  ,-80  ,-82  ,-84  ,-86  ,
	-87  ,-89  ,-91  ,-93  ,-95  ,-96  ,-98  ,-100 ,-102 ,-103 ,-105 ,-107 ,-109 ,
	-111 ,-112 ,-114 ,-116 ,-118 ,-119 ,-121 ,-123 ,-125 ,-127 ,-128 ,-130 ,-132 ,
	-134 ,-135 ,-137 ,-139 ,-141 ,-143 ,-144 ,-146 ,-148 ,-150 ,-151 ,-153 ,-155 ,
	-157 ,-158 ,-160 ,-162 ,-164 ,-165 ,-167 ,-169 ,-171 ,-173 ,-174 ,-176 ,-178 ,
	-180 ,-181 ,-183 ,-185 ,-187 ,-188 ,-190 ,-192 ,-194 ,-195 ,-197 ,-199 ,-201 ,
	-202 ,-204 ,-206 ,-208 ,-209 ,-211 ,-213 ,-215 ,-216 ,-218 ,-220 ,-222 ,-223 ,
	-225 ,-227 ,-229 ,-230 ,-232 ,-234 ,-236 ,-237 ,-239 ,-241 ,-243 ,-244 ,-246 ,
	-248 ,-249 ,-251 ,-253 ,-255 ,-256 ,-258 ,-260 ,-262 ,-263 ,-265 ,-267 ,-268 ,
	-270 ,-272 ,-274 ,-275 ,-277 ,-279 ,-281 ,-282 ,-284 ,-286 ,-287 ,-289 ,-291 ,
	-293 ,-294 ,-296 ,-298 ,-299 ,-301 ,-303 ,-305 ,-306 ,-308 ,-310 ,-311 ,-313 ,
	-315 ,-316 ,-318 ,-320 ,-322 ,-323 ,-325 ,-327 ,-328 ,-330 ,-332 ,-333 ,-335 ,
	-337 ,-338 ,-340 ,-342 ,-344 ,-345 ,-347 ,-349 ,-350 ,-352 ,-354 ,-355 ,-357 ,
	-359 ,-360 ,-362 ,-364 ,-365 ,-367 ,-369 ,-370 ,-372 ,-374 ,-375 ,-377 ,-379 ,
	-380 ,-382 ,-384 ,-385 ,-387 ,-389 ,-390 ,-392 ,-394 ,-395 ,-397 ,-398 ,-400 ,
	-402 ,-403 ,-405 ,-407 ,-408 ,-410 ,-412 ,-413 ,-415 ,-416 ,-418 ,-420 ,-421 ,
	-423 ,-425 ,-426 ,-428 ,-430 ,-431 ,-433 ,-434 ,-436 ,-438 ,-439 ,-441 ,-442 ,
	-444 ,-446 ,-447 ,-449 ,-450 ,-452 ,-454 ,-455 ,-457 ,-459 ,-460 ,-462 ,-463 ,
	-465 ,-466 ,-468 ,-470 ,-471 ,-473 ,-474 ,-476 ,-478 ,-479 ,-481 ,-482 ,-484 ,
	-485 ,-487 ,-489 ,-490 ,-492 ,-493 ,-495 ,-496 ,-498 ,-500 ,-501 ,-503 ,-504 ,
	-506 ,-507 ,-509 ,-510 ,-512 ,-514 ,-515 ,-517 ,-518 ,-520 ,-521 ,-523 ,-524 ,
	-526 ,-527 ,-529 ,-530 ,-532 ,-534 ,-535 ,-537 ,-538 ,-540 ,-541 ,-543 ,-544 ,
	-546 ,-547 ,-549 ,-550 ,-552 ,-553 ,-555 ,-556 ,-558 ,-559 ,-561 ,-562 ,-564 ,
	-565 ,-567 ,-568 ,-570 ,-571 ,-573 ,-574 ,-576 ,-577 ,-579 ,-580 ,-581 ,-583 ,
	-584 ,-586 ,-587 ,-589 ,-590 ,-592 ,-593 ,-595 ,-596 ,-598 ,-599 ,-600 ,-602 ,
	-603 ,-605 ,-606 ,-608 ,-609 ,-611 ,-612 ,-613 ,-615 ,-616 ,-618 ,-619 ,-621 ,
	-622 ,-623 ,-625 ,-626 ,-628 ,-629 ,-630 ,-632 ,-633 ,-635 ,-636 ,-637 ,-639 ,
	-640 ,-642 ,-643 ,-644 ,-646 ,-647 ,-649 ,-650 ,-651 ,-653 ,-654 ,-655 ,-657 ,
	-658 ,-660 ,-661 ,-662 ,-664 ,-665 ,-666 ,-668 ,-669 ,-670 ,-672 ,-673 ,-674 ,
	-676 ,-677 ,-679 ,-680 ,-681 ,-683 ,-684 ,-685 ,-687 ,-688 ,-689 ,-690 ,-692 ,
	-693 ,-694 ,-696 ,-697 ,-698 ,-700 ,-701 ,-702 ,-704 ,-705 ,-706 ,-707 ,-709 ,
	-710 ,-711 ,-713 ,-714 ,-715 ,-716 ,-718 ,-719 ,-720 ,-722 ,-723 ,-724 ,-725 ,
	-727 ,-728 ,-729 ,-730 ,-732 ,-733 ,-734 ,-735 ,-737 ,-738 ,-739 ,-740 ,-742 ,
	-743 ,-744 ,-745 ,-746 ,-748 ,-749 ,-750 ,-751 ,-753 ,-754 ,-755 ,-756 ,-757 ,
	-759 ,-760 ,-761 ,-762 ,-763 ,-765 ,-766 ,-767 ,-768 ,-769 ,-770 ,-772 ,-773 ,
	-774 ,-775 ,-776 ,-777 ,-779 ,-780 ,-781 ,-782 ,-783 ,-784 ,-786 ,-787 ,-788 ,
	-789 ,-790 ,-791 ,-792 ,-794 ,-795 ,-796 ,-797 ,-798 ,-799 ,-800 ,-801 ,-803 ,
	-804 ,-805 ,-806 ,-807 ,-808 ,-809 ,-810 ,-811 ,-812 ,-813 ,-815 ,-816 ,-817 ,
	-818 ,-819 ,-820 ,-821 ,-822 ,-823 ,-824 ,-825 ,-826 ,-827 ,-828 ,-829 ,-831 ,
	-832 ,-833 ,-834 ,-835 ,-836 ,-837 ,-838 ,-839 ,-840 ,-841 ,-842 ,-843 ,-844 ,
	-845 ,-846 ,-847 ,-848 ,-849 ,-850 ,-851 ,-852 ,-853 ,-854 ,-855 ,-856 ,-857 ,
	-858 ,-859 ,-860 ,-861 ,-862 ,-863 ,-864 ,-865 ,-866 ,-867 ,-867 ,-868 ,-869 ,
	-870 ,-871 ,-872 ,-873 ,-874 ,-875 ,-876 ,-877 ,-878 ,-879 ,-880 ,-880 ,-881 ,
	-882 ,-883 ,-884 ,-885 ,-886 ,-887 ,-888 ,-889 ,-889 ,-890 ,-891 ,-892 ,-893 ,
	-894 ,-895 ,-896 ,-896 ,-897 ,-898 ,-899 ,-900 ,-901 ,-902 ,-902 ,-903 ,-904 ,
	-905 ,-906 ,-907 ,-907 ,-908 ,-909 ,-910 ,-911 ,-912 ,-912 ,-913 ,-914 ,-915 ,
	-916 ,-916 ,-917 ,-918 ,-919 ,-920 ,-920 ,-921 ,-922 ,-923 ,-923 ,-924 ,-925 ,
	-926 ,-927 ,-927 ,-928 ,-929 ,-930 ,-930 ,-931 ,-932 ,-933 ,-933 ,-934 ,-935 ,
	-935 ,-936 ,-937 ,-938 ,-938 ,-939 ,-940 ,-940 ,-941 ,-942 ,-943 ,-943 ,-944 ,
	-945 ,-945 ,-946 ,-947 ,-947 ,-948 ,-949 ,-949 ,-950 ,-951 ,-951 ,-952 ,-953 ,
	-953 ,-954 ,-955 ,-955 ,-956 ,-957 ,-957 ,-958 ,-959 ,-959 ,-960 ,-960 ,-961 ,
	-962 ,-962 ,-963 ,-963 ,-964 ,-965 ,-965 ,-966 ,-966 ,-967 ,-968 ,-968 ,-969 ,
	-969 ,-970 ,-971 ,-971 ,-972 ,-972 ,-973 ,-973 ,-974 ,-974 ,-975 ,-976 ,-976 ,
	-977 ,-977 ,-978 ,-978 ,-979 ,-979 ,-980 ,-980 ,-981 ,-981 ,-982 ,-982 ,-983 ,
	-983 ,-984 ,-984 ,-985 ,-985 ,-986 ,-986 ,-987 ,-987 ,-988 ,-988 ,-989 ,-989 ,
	-990 ,-990 ,-990 ,-991 ,-991 ,-992 ,-992 ,-993 ,-993 ,-994 ,-994 ,-994 ,-995 ,
	-995 ,-996 ,-996 ,-997 ,-997 ,-997 ,-998 ,-998 ,-999 ,-999 ,-999 ,-1000,-1000,
	-1000,-1001,-1001,-1002,-1002,-1002,-1003,-1003,-1003,-1004,-1004,-1004,-1005,
	-1005,-1006,-1006,-1006,-1007,-1007,-1007,-1007,-1008,-1008,-1008,-1009,-1009,
	-1009,-1010,-1010,-1010,-1011,-1011,-1011,-1011,-1012,-1012,-1012,-1012,-1013,
	-1013,-1013,-1014,-1014,-1014,-1014,-1015,-1015,-1015,-1015,-1015,-1016,-1016,
	-1016,-1016,-1017,-1017,-1017,-1017,-1017,-1018,-1018,-1018,-1018,-1018,-1019,
	-1019,-1019,-1019,-1019,-1019,-1020,-1020,-1020,-1020,-1020,-1020,-1021,-1021,
	-1021,-1021,-1021,-1021,-1021,-1022,-1022,-1022,-1022,-1022,-1022,-1022,-1022,
	-1022,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,
	-1023,-1023,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,
	-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,
	-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1024,-1023,-1023,
	-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1023,-1022,
	-1022,-1022,-1022,-1022,-1022,-1022,-1022,-1022,-1021,-1021,-1021,-1021,-1021,
	-1021,-1021,-1020,-1020,-1020,-1020,-1020,-1020,-1019,-1019,-1019,-1019,-1019,
	-1019,-1018,-1018,-1018,-1018,-1018,-1017,-1017,-1017,-1017,-1017,-1016,-1016,
	-1016,-1016,-1015,-1015,-1015,-1015,-1015,-1014,-1014,-1014,-1014,-1013,-1013,
	-1013,-1012,-1012,-1012,-1012,-1011,-1011,-1011,-1011,-1010,-1010,-1010,-1009,
	-1009,-1009,-1008,-1008,-1008,-1007,-1007,-1007,-1007,-1006,-1006,-1006,-1005,
	-1005,-1004,-1004,-1004,-1003,-1003,-1003,-1002,-1002,-1002,-1001,-1001,-1000,
	-1000,-1000,-999 ,-999 ,-999 ,-998 ,-998 ,-997 ,-997 ,-997 ,-996 ,-996 ,-995 ,
	-995 ,-994 ,-994 ,-994 ,-993 ,-993 ,-992 ,-992 ,-991 ,-991 ,-990 ,-990 ,-990 ,
	-989 ,-989 ,-988 ,-988 ,-987 ,-987 ,-986 ,-986 ,-985 ,-985 ,-984 ,-984 ,-983 ,
	-983 ,-982 ,-982 ,-981 ,-981 ,-980 ,-980 ,-979 ,-979 ,-978 ,-978 ,-977 ,-977 ,
	-976 ,-976 ,-975 ,-974 ,-974 ,-973 ,-973 ,-972 ,-972 ,-971 ,-971 ,-970 ,-969 ,
	-969 ,-968 ,-968 ,-967 ,-966 ,-966 ,-965 ,-965 ,-964 ,-963 ,-963 ,-962 ,-962 ,
	-961 ,-960 ,-960 ,-959 ,-959 ,-958 ,-957 ,-957 ,-956 ,-955 ,-955 ,-954 ,-953 ,
	-953 ,-952 ,-951 ,-951 ,-950 ,-949 ,-949 ,-948 ,-947 ,-947 ,-946 ,-945 ,-945 ,
	-944 ,-943 ,-943 ,-942 ,-941 ,-940 ,-940 ,-939 ,-938 ,-938 ,-937 ,-936 ,-935 ,
	-935 ,-934 ,-933 ,-933 ,-932 ,-931 ,-930 ,-930 ,-929 ,-928 ,-927 ,-927 ,-926 ,
	-925 ,-924 ,-923 ,-923 ,-922 ,-921 ,-920 ,-920 ,-919 ,-918 ,-917 ,-916 ,-916 ,
	-915 ,-914 ,-913 ,-912 ,-912 ,-911 ,-910 ,-909 ,-908 ,-907 ,-907 ,-906 ,-905 ,
	-904 ,-903 ,-902 ,-902 ,-901 ,-900 ,-899 ,-898 ,-897 ,-896 ,-896 ,-895 ,-894 ,
	-893 ,-892 ,-891 ,-890 ,-889 ,-889 ,-888 ,-887 ,-886 ,-885 ,-884 ,-883 ,-882 ,
	-881 ,-880 ,-880 ,-879 ,-878 ,-877 ,-876 ,-875 ,-874 ,-873 ,-872 ,-871 ,-870 ,
	-869 ,-868 ,-867 ,-867 ,-866 ,-865 ,-864 ,-863 ,-862 ,-861 ,-860 ,-859 ,-858 ,
	-857 ,-856 ,-855 ,-854 ,-853 ,-852 ,-851 ,-850 ,-849 ,-848 ,-847 ,-846 ,-845 ,
	-844 ,-843 ,-842 ,-841 ,-840 ,-839 ,-838 ,-837 ,-836 ,-835 ,-834 ,-833 ,-832 ,
	-831 ,-829 ,-828 ,-827 ,-826 ,-825 ,-824 ,-823 ,-822 ,-821 ,-820 ,-819 ,-818 ,
	-817 ,-816 ,-815 ,-813 ,-812 ,-811 ,-810 ,-809 ,-808 ,-807 ,-806 ,-805 ,-804 ,
	-803 ,-801 ,-800 ,-799 ,-798 ,-797 ,-796 ,-795 ,-794 ,-792 ,-791 ,-790 ,-789 ,
	-788 ,-787 ,-786 ,-784 ,-783 ,-782 ,-781 ,-780 ,-779 ,-777 ,-776 ,-775 ,-774 ,
	-773 ,-772 ,-770 ,-769 ,-768 ,-767 ,-766 ,-765 ,-763 ,-762 ,-761 ,-760 ,-759 ,
	-757 ,-756 ,-755 ,-754 ,-753 ,-751 ,-750 ,-749 ,-748 ,-746 ,-745 ,-744 ,-743 ,
	-742 ,-740 ,-739 ,-738 ,-737 ,-735 ,-734 ,-733 ,-732 ,-730 ,-729 ,-728 ,-727 ,
	-725 ,-724 ,-723 ,-722 ,-720 ,-719 ,-718 ,-716 ,-715 ,-714 ,-713 ,-711 ,-710 ,
	-709 ,-707 ,-706 ,-705 ,-704 ,-702 ,-701 ,-700 ,-698 ,-697 ,-696 ,-694 ,-693 ,
	-692 ,-690 ,-689 ,-688 ,-687 ,-685 ,-684 ,-683 ,-681 ,-680 ,-679 ,-677 ,-676 ,
	-674 ,-673 ,-672 ,-670 ,-669 ,-668 ,-666 ,-665 ,-664 ,-662 ,-661 ,-660 ,-658 ,
	-657 ,-655 ,-654 ,-653 ,-651 ,-650 ,-649 ,-647 ,-646 ,-644 ,-643 ,-642 ,-640 ,
	-639 ,-637 ,-636 ,-635 ,-633 ,-632 ,-630 ,-629 ,-628 ,-626 ,-625 ,-623 ,-622 ,
	-621 ,-619 ,-618 ,-616 ,-615 ,-613 ,-612 ,-611 ,-609 ,-608 ,-606 ,-605 ,-603 ,
	-602 ,-600 ,-599 ,-598 ,-596 ,-595 ,-593 ,-592 ,-590 ,-589 ,-587 ,-586 ,-584 ,
	-583 ,-581 ,-580 ,-579 ,-577 ,-576 ,-574 ,-573 ,-571 ,-570 ,-568 ,-567 ,-565 ,
	-564 ,-562 ,-561 ,-559 ,-558 ,-556 ,-555 ,-553 ,-552 ,-550 ,-549 ,-547 ,-546 ,
	-544 ,-543 ,-541 ,-540 ,-538 ,-537 ,-535 ,-534 ,-532 ,-530 ,-529 ,-527 ,-526 ,
	-524 ,-523 ,-521 ,-520 ,-518 ,-517 ,-515 ,-514 ,-512 ,-510 ,-509 ,-507 ,-506 ,
	-504 ,-503 ,-501 ,-500 ,-498 ,-496 ,-495 ,-493 ,-492 ,-490 ,-489 ,-487 ,-485 ,
	-484 ,-482 ,-481 ,-479 ,-478 ,-476 ,-474 ,-473 ,-471 ,-470 ,-468 ,-466 ,-465 ,
	-463 ,-462 ,-460 ,-459 ,-457 ,-455 ,-454 ,-452 ,-450 ,-449 ,-447 ,-446 ,-444 ,
	-442 ,-441 ,-439 ,-438 ,-436 ,-434 ,-433 ,-431 ,-430 ,-428 ,-426 ,-425 ,-423 ,
	-421 ,-420 ,-418 ,-416 ,-415 ,-413 ,-412 ,-410 ,-408 ,-407 ,-405 ,-403 ,-402 ,
	-400 ,-398 ,-397 ,-395 ,-394 ,-392 ,-390 ,-389 ,-387 ,-385 ,-384 ,-382 ,-380 ,
	-379 ,-377 ,-375 ,-374 ,-372 ,-370 ,-369 ,-367 ,-365 ,-364 ,-362 ,-360 ,-359 ,
	-357 ,-355 ,-354 ,-352 ,-350 ,-349 ,-347 ,-345 ,-344 ,-342 ,-340 ,-338 ,-337 ,
	-335 ,-333 ,-332 ,-330 ,-328 ,-327 ,-325 ,-323 ,-322 ,-320 ,-318 ,-316 ,-315 ,
	-313 ,-311 ,-310 ,-308 ,-306 ,-305 ,-303 ,-301 ,-299 ,-298 ,-296 ,-294 ,-293 ,
	-291 ,-289 ,-287 ,-286 ,-284 ,-282 ,-281 ,-279 ,-277 ,-275 ,-274 ,-272 ,-270 ,
	-268 ,-267 ,-265 ,-263 ,-262 ,-260 ,-258 ,-256 ,-255 ,-253 ,-251 ,-249 ,-248 ,
	-246 ,-244 ,-243 ,-241 ,-239 ,-237 ,-236 ,-234 ,-232 ,-230 ,-229 ,-227 ,-225 ,
	-223 ,-222 ,-220 ,-218 ,-216 ,-215 ,-213 ,-211 ,-209 ,-208 ,-206 ,-204 ,-202 ,
	-201 ,-199 ,-197 ,-195 ,-194 ,-192 ,-190 ,-188 ,-187 ,-185 ,-183 ,-181 ,-180 ,
	-178 ,-176 ,-174 ,-173 ,-171 ,-169 ,-167 ,-165 ,-164 ,-162 ,-160 ,-158 ,-157 ,
	-155 ,-153 ,-151 ,-150 ,-148 ,-146 ,-144 ,-143 ,-141 ,-139 ,-137 ,-135 ,-134 ,
	-132 ,-130 ,-128 ,-127 ,-125 ,-123 ,-121 ,-119 ,-118 ,-116 ,-114 ,-112 ,-111 ,
	-109 ,-107 ,-105 ,-103 ,-102 ,-100 ,-98  ,-96  ,-95  ,-93  ,-91  ,-89  ,-87  ,
	-86  ,-84  ,-82  ,-80  ,-79  ,-77  ,-75  ,-73  ,-71  ,-70  ,-68  ,-66  ,-64  ,
	-63  ,-61  ,-59  ,-57  ,-55  ,-54  ,-52  ,-50  ,-48  ,-46  ,-45  ,-43  ,-41  ,
	-39  ,-38  ,-36  ,-34  ,-32  ,-30  ,-29  ,-27  ,-25  ,-23  ,-21  ,-20  ,-18  ,
	-16  ,-14  ,-13  ,-11  ,-9   ,-7   ,-5   ,-4   ,-2   ,0    ,2    ,4    ,5    ,
	7    ,9    ,11   ,13   ,14   ,16   ,18   ,20   ,21   ,23   ,25   ,27   ,29   ,
	30   ,32   ,34   ,36   ,38   ,39   ,41   ,43   ,45   ,46   ,48   ,50   ,52   ,
	54   ,55   ,57   ,59   ,61   ,63   ,64   ,66   ,68   ,70   ,71   ,73   ,75   ,
	77   ,79   ,80   ,82   ,84   ,86   ,87   ,89   ,91   ,93   ,95   ,96   ,98   ,
	100  ,102  ,103  ,105  ,107  ,109  ,111  ,112  ,114  ,116  ,118  ,119  ,121  ,
	123  ,125  ,127  ,128  ,130  ,132  ,134  ,135  ,137  ,139  ,141  ,143  ,144  ,
	146  ,148  ,150  ,151  ,153  ,155  ,157  ,158  ,160  ,162  ,164  ,165  ,167  ,
	169  ,171  ,173  ,174  ,176  ,178  ,180  ,181  ,183  ,185  ,187  ,188  ,190  ,
	192  ,194  ,195  ,197  ,199  ,201  ,202  ,204  ,206  ,208  ,209  ,211  ,213  ,
	215  ,216  ,218  ,220  ,222  ,223  ,225  ,227  ,229  ,230  ,232  ,234  ,236  ,
	237  ,239  ,241  ,243  ,244  ,246  ,248  ,249  ,251  ,253  ,255  ,256  ,258  ,
	260  ,262  ,263  ,265  ,267  ,268  ,270  ,272  ,274  ,275  ,277  ,279  ,281  ,
	282  ,284  ,286  ,287  ,289  ,291  ,293  ,294  ,296  ,298  ,299  ,301  ,303  ,
	305  ,306  ,308  ,310  ,311  ,313  ,315  ,316  ,318  ,320  ,322  ,323  ,325  ,
	327  ,328  ,330  ,332  ,333  ,335  ,337  ,338  ,340  ,342  ,344  ,345  ,347  ,
	349  ,350  ,352  ,354  ,355  ,357  ,359  ,360  ,362  ,364  ,365  ,367  ,369  ,
	370  ,372  ,374  ,375  ,377  ,379  ,380  ,382  ,384  ,385  ,387  ,389  ,390  ,
	392  ,394  ,395  ,397  ,398  ,400  ,402  ,403  ,405  ,407  ,408  ,410  ,412  ,
	413  ,415  ,416  ,418  ,420  ,421  ,423  ,425  ,426  ,428  ,430  ,431  ,433  ,
	434  ,436  ,438  ,439  ,441  ,442  ,444  ,446  ,447  ,449  ,450  ,452  ,454  ,
	455  ,457  ,459  ,460  ,462  ,463  ,465  ,466  ,468  ,470  ,471  ,473  ,474  ,
	476  ,478  ,479  ,481  ,482  ,484  ,485  ,487  ,489  ,490  ,492  ,493  ,495  ,
	496  ,498  ,500  ,501  ,503  ,504  ,506  ,507  ,509  ,510  ,512  ,514  ,515  ,
	517  ,518  ,520  ,521  ,523  ,524  ,526  ,527  ,529  ,530  ,532  ,534  ,535  ,
	537  ,538  ,540  ,541  ,543  ,544  ,546  ,547  ,549  ,550  ,552  ,553  ,555  ,
	556  ,558  ,559  ,561  ,562  ,564  ,565  ,567  ,568  ,570  ,571  ,573  ,574  ,
	576  ,577  ,579  ,580  ,581  ,583  ,584  ,586  ,587  ,589  ,590  ,592  ,593  ,
	595  ,596  ,598  ,599  ,600  ,602  ,603  ,605  ,606  ,608  ,609  ,611  ,612  ,
	613  ,615  ,616  ,618  ,619  ,621  ,622  ,623  ,625  ,626  ,628  ,629  ,630  ,
	632  ,633  ,635  ,636  ,637  ,639  ,640  ,642  ,643  ,644  ,646  ,647  ,649  ,
	650  ,651  ,653  ,654  ,655  ,657  ,658  ,660  ,661  ,662  ,664  ,665  ,666  ,
	668  ,669  ,670  ,672  ,673  ,674  ,676  ,677  ,679  ,680  ,681  ,683  ,684  ,
	685  ,687  ,688  ,689  ,690  ,692  ,693  ,694  ,696  ,697  ,698  ,700  ,701  ,
	702  ,704  ,705  ,706  ,707  ,709  ,710  ,711  ,713  ,714  ,715  ,716  ,718  ,
	719  ,720  ,722  ,723  ,724  ,725  ,727  ,728  ,729  ,730  ,732  ,733  ,734  ,
	735  ,737  ,738  ,739  ,740  ,742  ,743  ,744  ,745  ,746  ,748  ,749  ,750  ,
	751  ,753  ,754  ,755  ,756  ,757  ,759  ,760  ,761  ,762  ,763  ,765  ,766  ,
	767  ,768  ,769  ,770  ,772  ,773  ,774  ,775  ,776  ,777  ,779  ,780  ,781  ,
	782  ,783  ,784  ,786  ,787  ,788  ,789  ,790  ,791  ,792  ,794  ,795  ,796  ,
	797  ,798  ,799  ,800  ,801  ,803  ,804  ,805  ,806  ,807  ,808  ,809  ,810  ,
	811  ,812  ,813  ,815  ,816  ,817  ,818  ,819  ,820  ,821  ,822  ,823  ,824  ,
	825  ,826  ,827  ,828  ,829  ,831  ,832  ,833  ,834  ,835  ,836  ,837  ,838  ,
	839  ,840  ,841  ,842  ,843  ,844  ,845  ,846  ,847  ,848  ,849  ,850  ,851  ,
	852  ,853  ,854  ,855  ,856  ,857  ,858  ,859  ,860  ,861  ,862  ,863  ,864  ,
	865  ,866  ,867  ,867  ,868  ,869  ,870  ,871  ,872  ,873  ,874  ,875  ,876  ,
	877  ,878  ,879  ,880  ,880  ,881  ,882  ,883  ,884  ,885  ,886  ,887  ,888  ,
	889  ,889  ,890  ,891  ,892  ,893  ,894  ,895  ,896  ,896  ,897  ,898  ,899  ,
	900  ,901  ,902  ,902  ,903  ,904  ,905  ,906  ,907  ,907  ,908  ,909  ,910  ,
	911  ,912  ,912  ,913  ,914  ,915  ,916  ,916  ,917  ,918  ,919  ,920  ,920  ,
	921  ,922  ,923  ,923  ,924  ,925  ,926  ,927  ,927  ,928  ,929  ,930  ,930  ,
	931  ,932  ,933  ,933  ,934  ,935  ,935  ,936  ,937  ,938  ,938  ,939  ,940  ,
	940  ,941  ,942  ,943  ,943  ,944  ,945  ,945  ,946  ,947  ,947  ,948  ,949  ,
	949  ,950  ,951  ,951  ,952  ,953  ,953  ,954  ,955  ,955  ,956  ,957  ,957  ,
	958  ,959  ,959  ,960  ,960  ,961  ,962  ,962  ,963  ,963  ,964  ,965  ,965  ,
	966  ,966  ,967  ,968  ,968  ,969  ,969  ,970  ,971  ,971  ,972  ,972  ,973  ,
	973  ,974  ,974  ,975  ,976  ,976  ,977  ,977  ,978  ,978  ,979  ,979  ,980  ,
	980  ,981  ,981  ,982  ,982  ,983  ,983  ,984  ,984  ,985  ,985  ,986  ,986  ,
	987  ,987  ,988  ,988  ,989  ,989  ,990  ,990  ,990  ,991  ,991  ,992  ,992  ,
	993  ,993  ,994  ,994  ,994  ,995  ,995  ,996  ,996  ,997  ,997  ,997  ,998  ,
	998  ,999  ,999  ,999  ,1000 ,1000 ,1000 ,1001 ,1001 ,1002 ,1002 ,1002 ,1003 ,
	1003 ,1003 ,1004 ,1004 ,1004 ,1005 ,1005 ,1006 ,1006 ,1006 ,1007 ,1007 ,1007 ,
	1007 ,1008 ,1008 ,1008 ,1009 ,1009 ,1009 ,1010 ,1010 ,1010 ,1011 ,1011 ,1011 ,
	1011 ,1012 ,1012 ,1012 ,1012 ,1013 ,1013 ,1013 ,1014 ,1014 ,1014 ,1014 ,1015 ,
	1015 ,1015 ,1015 ,1015 ,1016 ,1016 ,1016 ,1016 ,1017 ,1017 ,1017 ,1017 ,1017 ,
	1018 ,1018 ,1018 ,1018 ,1018 ,1019 ,1019 ,1019 ,1019 ,1019 ,1019 ,1020 ,1020 ,
	1020 ,1020 ,1020 ,1020 ,1021 ,1021 ,1021 ,1021 ,1021 ,1021 ,1021 ,1022 ,1022 ,
	1022 ,1022 ,1022 ,1022 ,1022 ,1022 ,1022 ,1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,
	1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,1023 ,1024 ,1024 ,1024 ,1024 ,1024 ,
	1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 ,1024 
};

#ifdef	D_32BIT
unsigned long*	g_ScreenEX;
#else
unsigned short*	g_ScreenEX;
#endif
tmScanPoint*	g_pPtStack = NULL;

//	fans add
void	MemSet_4(void* dest, int nData, int nCount)
{
	//__asm
	//(
	//	"mov dest, edi;
	//	mov nCount,ecx;
	//	mov nData, eax;
	//	rep stosd;"
	//);
}

//	fans add
void	MemSet_2(void* dest, WORD wData, int nCount)
{
	//__asm
	//(
		//"mov edit, dest;\\n\\t"
		//"mov ecx, nCount;\\n\\t"
		//"mov ax, nData;\\n\\t"
		//"rep stosw"
	//);
}

void	_GuiInitEx()
{
	//g_ScreenEX = new WORD[g_infoDrv.nX * g_infoDrv.nY];
	#ifdef	D_32BIT
	g_ScreenEX = (unsigned long*)g_infoDrv.pcMem;
	#else
	g_ScreenEX = (unsigned short*)g_infoDrv.pcMem;
	#endif
	g_pPtStack = NULL;
}

void	_SetPointColorEx(int x, int y, int Color)
{
	if (x < 0 || y < 0 || x >= g_infoDrv.nX || y >= g_infoDrv.nY) return;
	g_ScreenEX[y * g_infoDrv.nX + x] =Color;	
}

int		_GetPointColorEx(int x, int y)
{
	
	int nResult = 0;
	if (x < 0 || y < 0 || x >= g_infoDrv.nX || y >= g_infoDrv.nY) nResult = 0;
	else 
	{
		nResult = g_ScreenEX[y  * g_infoDrv.nX + x];
	}
	return nResult;
}

void	FreeStack(tmScanPoint* pStack)
{
	if (pStack == NULL) return;
	if (pStack->pNext != NULL) 
	{
		FreeStack(pStack->pNext);
		delete pStack->pNext;
		pStack->pNext = NULL;
	}
}

void	SetPtStackEmpty()
{
	if (g_pPtStack != NULL) 
	{
		FreeStack(g_pPtStack);
		delete g_pPtStack;
		g_pPtStack = NULL;
	}
	
	
}

void	PushStack(int x, int y)
{
	tmScanPoint* pTemp = (tmScanPoint* )malloc(sizeof(tmScanPoint));//new tmScanPoint;
	
	pTemp->x = x;
	pTemp->y = y;
	pTemp->pNext = g_pPtStack;
	g_pPtStack = pTemp;
}

void	PopStack(int* x, int* y)
{
	tmScanPoint* pTemp = g_pPtStack;
	*x = pTemp->x;
	*y = pTemp->y;
	g_pPtStack = pTemp->pNext;
	
	//delete pTemp;
	if(pTemp!=NULL)
	{
		free(pTemp);
		pTemp=NULL;	
	}
}

void	_LineEx(int x0, int y0, int x1, int y1, int Color)
{
	_SetViewPort(0, 0, g_infoDrv.nX - 1, g_infoDrv.nY - 1);
	_SetColor(Color);
	_Line(x0, y0, x1, y1);
}

void	_FillRegionEx(int x, int y, int NewColor)
{
	//memcpy(g_ScreenEX, g_infoDrv.pcMem, g_infoDrv.nX * g_infoDrv.nY * 2);
	
	if (x < 0 || y < 0 || x >= g_infoDrv.nX || y >= g_infoDrv.nY) return;
	
	int OldColor = _GetPointColorEx(x, y);
	
	if (OldColor == NewColor) return;
	
	int xl, xr, i;		//	xl Â∑¶Ëµ∑ÈªûÔºåxrÂè≥Ëµ∑Èª?
	bool spanNeedFill;
	
	SetPtStackEmpty();
	tmScanPoint pt;
	
	pt.x = x; 
	pt.y = y;
	
	PushStack(pt.x, pt.y);
	while (g_pPtStack != NULL)
	{
		PopStack(&pt.x, &pt.y);
		
		//	ÂêëÂè≥Áπ™Áï´
		y = pt.y;
		x = pt.x;
		while (_GetPointColorEx(x, y) == OldColor)
		{
			_SetPointColorEx(x, y, NewColor);
			x++;
			
		}
		
		//	ÂêëÂ∑¶Áπ™Áï´
		xr = x - 1;
		x = pt.x - 1;
		while (_GetPointColorEx(x, y) == OldColor)
		{
			_SetPointColorEx(x, y, NewColor);
			x--;	
		}
		xl = x + 1;
		
		//	ËôïÁêÜ‰∏äÈù¢ÁöÑ‰∏ÄÊ¢ùÁ∂´
		x = xl;
		y = y + 1;
		while (x < xr)
		{
			spanNeedFill = false;
			while (_GetPointColorEx(x, y) == OldColor)
			{
				spanNeedFill = true;
				x++;
			}
			
			if (spanNeedFill)
			{
				pt.x = x - 1; 
				pt.y = y;
				PushStack(pt.x, pt.y);
				spanNeedFill = false;
			}
			
			while (_GetPointColorEx(x, y) != OldColor && x < xr) x++;
			
		}
		
		//	ËôïÁêÜ‰∏ãÈù¢ÁöÑ‰∏ÄÊ¢ùÁ∂´
		x = xl;
		y = y - 2;
		while (x < xr)
		{
			
			spanNeedFill = false;
			while (_GetPointColorEx(x, y) == OldColor)
			{
				spanNeedFill = true;
				x++;
			}
			
			if (spanNeedFill)
			{
				pt.x = x - 1; 
				pt.y = y;
				PushStack(pt.x, pt.y);
				spanNeedFill = false;
			}
			
			while (_GetPointColorEx(x, y) != OldColor && x<xr) x++;
			
		}
		
		
	}
	//memcpy(g_infoDrv.pcMem, g_ScreenEX,g_infoDrv.nX * g_infoDrv.nY * 2);
	
	
}

int		_GetColorWithLight(int r, int g, int b, 
						   int nDiffuseAngle, int nDiffuseQ,
						   int nReflectAngle, int nReflectQ,
						   int nEnvironmentR, int nEnvironmentG, int nEnvironmentB,
						   int nReflet)
{
	if (nReflet <= 0) return 0;
	
	int nRNew = 0, nGNew = 0, nBNew = 0;
	int	nReflet_R = 0, nReflet_G = 0, nReflet_B = 0;
	
	for (int i = 0; i < nReflet; i++)
	{
		if (i == 0)
		{
			nReflet_R = (r * nReflectQ * Power(Cos[nReflectAngle], 2)) >> 20;
			nReflet_G = (g * nReflectQ * Power(Cos[nReflectAngle], 2)) >> 20;
			nReflet_B = (b * nReflectQ * Power(Cos[nReflectAngle], 2)) >> 20;
		}
		else
		{
			nReflet_R = (nReflet_R *  Power(Cos[nReflectAngle], 2)) >> 20;
			nReflet_G = (nReflet_G *  Power(Cos[nReflectAngle], 2)) >> 20;
			nReflet_B = (nReflet_B *  Power(Cos[nReflectAngle], 2)) >> 20;
			
		}
	}
	
	
	nRNew = nEnvironmentR +  ( (r * nReflectQ * Cos[nDiffuseAngle]) >> 20) + nReflet_R;
	nGNew = nEnvironmentG +  ( (g * nReflectQ * Cos[nDiffuseAngle]) >> 20) + nReflet_G;
	nBNew = nEnvironmentB +  ( (b * nReflectQ * Cos[nDiffuseAngle]) >> 20) + nReflet_B;
			
	if (nRNew > 255) nRNew = 255;
	else if (nRNew < 0) nRNew = 0;
	
	if (nGNew > 255) nGNew = 255;
	else if (nGNew < 0) nGNew = 0;
	
	if (nBNew > 255) nBNew = 255;
	else if (nBNew < 0) nBNew = 0;
	
	#ifdef	D_32BIT
	return RGB2PIXEL888(nRNew, nGNew, nBNew);
	#else		
	return RGB2PIXEL(nRNew, nGNew, nBNew);
	#endif
}

void	_FillRegionWithLightEx(int x, int y, int r, int g, int b)
{
	
	//RGB2PIXEL
	#ifdef	D_32BIT
	int	NewColor = RGB2PIXEL888(r, g, b);
	#else
	int NewColor = RGB2PIXEL(r, g, b);
	#endif
	if (x < 0 || y < 0 || x >= g_infoDrv.nX || y >= g_infoDrv.nY) return;
	
	int OldColor = _GetPointColorEx(x, y);
	
	if (OldColor == NewColor) return;
	
	int xl, xr, i;		//	xl Â∑¶Ëµ∑ÈªûÔºåxrÂè≥Ëµ∑Èª?
	bool spanNeedFill;
	
	SetPtStackEmpty();
	tmScanPoint pt;
	
	pt.x = x; 
	pt.y = y;
	
	PushStack(pt.x, pt.y);
	int	nDiffuse_Angle = 300;	//	Êº´ÂèçÂ∞ÑËßíÔº?0Â∫?
	int	nReflect_Angle = 150;   //	Èè°Èù¢ÂèçÂ∞ÑÂÖâÂíåË¶ñÁ∑öÁöÑËßíÂ∫?
	int	nDiffuse_R = 1024;		//	Êº´ÂèçÂ∞ÑRÁöÑÂèçÂ∞Ñ‰øÇÊï∏ÔºåÊì¥Â§ß‰∫?024ÂÄ?
	int	nDiffuse_G = 1024;		//	Êº´ÂèçÂ∞ÑGÁöÑÂèçÂ∞Ñ‰øÇÊï∏ÔºåÊì¥Â§ß‰∫?024ÂÄ?
	int	nDiffuse_B = 1024;		//	Êº´ÂèçÂ∞ÑBÁöÑÂèçÂ∞Ñ‰øÇÊï∏ÔºåÊì¥Â§ß‰∫?024ÂÄ?
	
	
	int	nDiffuse_R_New = 0;
	int	nDiffuse_G_New = 0;
	int	nDiffuse_B_New = 0;
	
	
	int	nEnvironment = 100;		//	ÁéØÂ¢ÉÂÖ?
	//int 	sinA = 
	while (g_pPtStack != NULL)
	{
		nDiffuse_Angle +=1;
		nReflect_Angle +=1;
		PopStack(&pt.x, &pt.y);
		
		//	ÂêëÂè≥Áπ™Áï´
		y = pt.y;
		x = pt.x;
		//nDiffuse_R_New = nEnvironment +( (r * nDiffuse_R * Cos[nDiffuse_Angle]) >> 20) +
		//				( (r * Power((Cos[nReflect_Angle]), 2)) >> 20 );
		//				 //(r * ((1 * )) >> 20) * Power(abs(Cos[nReflect_Angle]), 2)) >> 20;	//	Á∂ìÈÅéÊº´ÂèçÂ∞Ñ‰ª•ÂæåÁöÑRÁöÑÂÄ?
		//nDiffuse_G_New = nEnvironment +( (g * nDiffuse_G * Cos[nDiffuse_Angle]) >> 20  )+
		//				 ((g * ((220 * Power((Cos[nReflect_Angle]), 2)) >> 20) * Power(abs(Cos[nReflect_Angle]), 2)) >> 20);	//	Á∂ìÈÅéÊº´ÂèçÂ∞Ñ‰ª•ÂæåÁöÑGÁöÑÂÄ?
		//nDiffuse_B_New = nEnvironment + (b * nDiffuse_B * Cos[nDiffuse_Angle]) >> 20 +
		//				 ((b * ((220 * Power((Cos[nReflect_Angle]), 2)) >> 20) * Power(abs(Cos[nReflect_Angle]), 2)) >> 20);	//	Á∂ìÈÅéÊº´ÂèçÂ∞Ñ‰ª•ÂæåÁöÑBÁöÑÂÄ?
		//NewColor = RGB2PIXEL(nDiffuse_R_New, nDiffuse_G_New, nDiffuse_B_New);
		
		NewColor = _GetColorWithLight(r, g, b, nDiffuse_Angle, nDiffuse_R, nReflect_Angle, 1, 
									  nEnvironment, nEnvironment, nEnvironment);
		
		while (_GetPointColorEx(x, y) == OldColor)
		{
			_SetPointColorEx(x, y, NewColor);
			x++;
		}
		
		//	ÂêëÂ∑¶Áπ™Áï´
		xr = x - 1;
		x = pt.x - 1;
		while (_GetPointColorEx(x, y) == OldColor)
		{
			_SetPointColorEx(x, y, NewColor);
			x--;	
		}
		xl = x + 1;
		
		//	ËôïÁêÜ‰∏ãÈù¢ÁöÑ‰∏ÄÊ¢ùÁ∂´
		x = xl;
		y = y + 1;
		nDiffuse_Angle += 1;
		nReflect_Angle +=1;
		NewColor = _GetColorWithLight(r, g, b, nDiffuse_Angle, nDiffuse_R, nReflect_Angle, 1, 
									  nEnvironment, nEnvironment, nEnvironment);
		while (x < xr)
		{
			spanNeedFill = false;
			while (_GetPointColorEx(x, y) == OldColor)
			{
				spanNeedFill = true;
				x++;
			}
			
			if (spanNeedFill)
			{
				pt.x = x - 1; 
				pt.y = y;
				PushStack(pt.x, pt.y);
				spanNeedFill = false;
			}
			
			while (_GetPointColorEx(x, y) != OldColor && x < xr) x++;
			
		}
		
		//	ËôïÁêÜ‰∏äÈù¢ÁöÑ‰∏ÄÊ¢ùÁ∂´
		x = xl;
		y = y - 2;
		nDiffuse_Angle -= 2;
		nReflect_Angle +=2;
		
		NewColor = _GetColorWithLight(r, g, b, nDiffuse_Angle, nDiffuse_R, nReflect_Angle, 1, 
									  nEnvironment, nEnvironment, nEnvironment);
		while (x < xr)
		{
			
			spanNeedFill = false;
			while (_GetPointColorEx(x, y) == OldColor)
			{
				spanNeedFill = true;
				x++;
			}
			
			if (spanNeedFill)
			{
				pt.x = x - 1; 
				pt.y = y;
				PushStack(pt.x, pt.y);
				spanNeedFill = false;
			}
			
			while (_GetPointColorEx(x, y) != OldColor && x<xr) x++;
			
		}
		
		
	}
	
	
}

void	_FillRegionEx(tmPointEx*	points, int num, int Color)
{
	#define Find_Index_ForWord(index)	index = (index + 1) % num;
	#define Find_Index_BackWord(index)	index = (index - 1 + num) % num;
	
	if(num < 3) return;
	
	int lx1,ly1,lx2,ly2,rx1,ry1,rx2,ry2,ldx,ldy,rdx,rdy;
	int minY,maxY,lindex,rindex,lxinc,rxinc,lxadd,rxadd,lxsgn,rxsgn,lxsum,rxsum;
	int i,x1,x2;
	
	rindex = lindex = 0;
	maxY=minY=points[0].y;
	
	for (i = 0; i < num; i++)
	{	
		if (points[i].y < minY)				//	find min on y
			minY = points[lindex = i].y;
		else if(points[i].y > maxY)		//	find max on y
				maxY = points[i].y;
	}
	
	if(minY == maxY) return;
 	
 	
 	rindex = lindex;
 	
 	while(points[lindex].y == minY)
		Find_Index_ForWord(lindex);
	
	Find_Index_BackWord(lindex);
	
	while(points[rindex].y == minY)
		Find_Index_BackWord(rindex);
		
		
	Find_Index_ForWord(rindex);
	lx1 = points[lindex].x;
	ly1 = points[lindex].y;
	Find_Index_ForWord(lindex);
	//Find_Index_BackWord(lindex);
	lx2 = points[lindex].x;
	ly2 = points[lindex].y;
	ldx = lx2 - lx1;
	ldy = ly2 - ly1;
	lxsgn = (ldx >= 0)?1:-1;
	if(ldy>0)
	{	lxadd = ldx/ldy;
		lxinc = (ldx%ldy)*lxsgn;
	}
	
		rx1 = points[rindex].x;
	ry1 = points[rindex].y;
	Find_Index_BackWord(rindex);
	rx2 = points[rindex].x;
	ry2 = points[rindex].y;
	rdx = rx2 - rx1;
	rdy = ry2 - ry1;
	rxsgn = (rdx >= 0)?1:-1;
	if(rdy>0)
	{	rxadd = rdx/rdy;
		rxinc = (rdx%rdy)*rxsgn;
	}
	lxsum = 0;
	rxsum = 0;
	minY++;
//p += pitch*minY;

	int p = minY;
	while(minY <= maxY)
	{	
		lxsum+=lxinc;
		lx1+=lxadd;
		
		if(lxsum >= ldy)
		{	
			lx1+=lxsgn;
			lxsum -= ldy;
		}
		rxsum+=rxinc;
		rx1+=rxadd;
		if(rxsum >= rdy)
		{	
			rx1+=rxsgn;
			rxsum -= rdy;
		}
		x1 = lx1,x2 = rx1 - 1;
		
		while (x1 < x2)
		{	
			_SetPointColorEx(x1, minY, Color);
			x1++;
		}
		
		if(minY == ly2)
		{	do{	
				lx1 = points[lindex].x;
				ly1 = points[lindex].y;
				Find_Index_ForWord(lindex);
				//Find_Index_BackWord(lindex);
				lx2 = points[lindex].x;
				ly2 = points[lindex].y;
			}while(ly2 == ly1);
			ldx = lx2 - lx1;
			ldy = ly2 - ly1;
			lxsgn = (ldx >= 0)?1:-1;
			if(ldy>0)
			{	lxadd = ldx/ldy;
				lxinc = (ldx%ldy)*lxsgn;
			}
		}
		if(minY == ry2)
		{	do{
				rx1 = points[rindex].x;
				ry1 = points[rindex].y;
				Find_Index_BackWord(rindex);
				//Find_Index_ForWord(rindex);
				rx2 = points[rindex].x;
				ry2 = points[rindex].y;
			}while(ry2 == ry1);
			rdx = rx2 - rx1;
			rdy = ry2 - ry1;
			rxsgn = (rdx >= 0)?1:-1;
			if(rdy>0);
			{	rxadd = rdx/rdy;
				rxinc = (rdx%rdy)*rxsgn;
			}
		}
		minY++;
	}
	
}

void	_MoveToEx(int x, int y)
{
	_SetViewPort(0, 0, g_infoDrv.nX - 1, g_infoDrv.nY - 1);
	_MoveTo(x, y);
}

void	_LineToEx(int x, int y, int Color)
{
	_SetColor(Color);
	_LineTo(x, y);
}


void	_DoubleBuffer(RECT rect, unsigned short* pSource)
{
	int XCycleTime = 0, XSpareTime = 0;
	int offsetx1 = 0, offsety1 = 0, offsetx2 = 0, offsety2 = 0;
	int i,j;
	short 	Temp;
	#ifdef	D_32BIT
	unsigned long* 		pobjective;
	#else
	unsigned short* 	pobjective;
	#endif
	//==============
	//adjust coordinate Ω’æ„Æyº–
	//==============
	if(rect.left > rect.right) 
	{
		Temp		= rect.right;
		rect.right	= rect.left;
		rect.left	= Temp;
	}
	if(rect.top > rect.bottom)
	{
		Temp		= rect.bottom;
		rect.bottom	= rect.top;
		rect.top	= Temp;
	}
	//=============
	//overstep display area
	//=============
	if(rect.left > m_nRgnMax_X && rect.top > m_nRgnMax_Y
		&& rect.right < m_nRgnMin_X && rect.bottom < m_nRgnMin_Y)
		return ;
	//================
	//adjust confine coordinate
	//================
	if(rect.left < m_nRgnMin_X)			
	{
		offsetx1 = m_nRgnMin_X - rect.left; 
		rect.left 	= m_nRgnMin_X;
	}
	if(rect.top < m_nRgnMin_Y)			
	{
		offsety1 = m_nRgnMin_Y - rect.top; 
		rect.top	= m_nRgnMin_Y;
	}
	if(rect.right > m_nRgnMax_X)		
	{
		offsetx2 = rect.right - m_nRgnMax_X;
		rect.right	= m_nRgnMax_X;
	}
	if(rect.bottom > m_nRgnMax_Y)		
	{
		offsety2 = rect.bottom - m_nRgnMax_Y;
		rect.bottom	= m_nRgnMax_Y;
	}
		
	XCycleTime = (rect.right - rect.left + 1) / BMP_GRIDINGPXEIL; 		//	x coordinate axis cycle Num
	XSpareTime = (rect.right - rect.left + 1) % BMP_GRIDINGPXEIL;		// 	x coordinate axis spare Num
	
	for(i = rect.top ;i <= rect.bottom; i++)
	{
		pobjective = &g_Rows[i][rect.left];
		for(j = 0; j < XCycleTime; j ++)
		{
			#ifdef	D_32BIT
			if(memcmp(pSource,pobjective,sizeof(unsigned long)*BMP_GRIDINGPXEIL) != 0)
				memcpy(pobjective,pSource,sizeof(unsigned long)*BMP_GRIDINGPXEIL);
			#else
			if(memcmp(pSource,pobjective,sizeof(unsigned short)*BMP_GRIDINGPXEIL) != 0)
				memcpy(pobjective,pSource,sizeof(unsigned short)*BMP_GRIDINGPXEIL);
			#endif
			pSource += BMP_GRIDINGPXEIL;
			pobjective += BMP_GRIDINGPXEIL;
		}
		if(XSpareTime != 0)
		{
			#ifdef	D_32BIT
			if(memcmp(pSource,pobjective,sizeof(unsigned long)*XSpareTime) != 0)
				memcpy(pobjective,pSource,sizeof(unsigned long)*XSpareTime);
			#else
			if(memcmp(pSource,pobjective,sizeof(unsigned short)*XSpareTime) != 0)
				memcpy(pobjective,pSource,sizeof(unsigned short)*XSpareTime);
			#endif
			pSource += XSpareTime;
		}
	}
}


//	ª›≠n™`∑N™∫¨O,CtmGDIDoubleBuffer®√§£¿À¥˙µπ©w™∫Æyº–∂WπL§F¶X™kΩd≥Ú®S¶≥
CtmGDIDoubleBuffer::CtmGDIDoubleBuffer(RECT rect)
{
	
	memset(&m_rect, 0, sizeof(m_rect));
	m_pBuffer = NULL;
	SetRegion(rect);
	
	//m_pBuffer = (unsigned short*)malloc((m_rect.right - m_rect.left + 1) * (m_rect.bottom - m_rect.top + 1) * sizeof(unsigned short));
	m_nColor = 0;
	m_nWriteMode = _GPSET;
	m_nCurrent_X = 0;
	m_nCurrent_Y = 0;
	m_nPerLen = BMP_GRIDINGPXEIL;
	

	//for(int i = 0; i < g_infoDrv.nY; i++)
	for(int i = 0; i < 2048; i++)
	{
		#ifdef	D_32BIT
		m_FrameBuffer[i] = (unsigned long *)pMem/*g_infoDrv.pcMem*/ + i * g_infoDrv.nX;
		#else
		m_FrameBuffer[i] = (unsigned short *)pMem/*g_infoDrv.pcMem*/ + i * g_infoDrv.nX;
		#endif
	}
	
}

CtmGDIDoubleBuffer::CtmGDIDoubleBuffer()
{
	m_pBuffer 		= NULL;
	m_nColor 		= 0;
	m_nWriteMode 	= _GPSET;
	m_nCurrent_X 	= 0;
	m_nCurrent_Y 	= 0;
	m_nPerLen 		= BMP_GRIDINGPXEIL;
	memset(&m_rect, 0, sizeof(m_rect));
	

	//for(int i = 0; i < g_infoDrv.nY; i++)
	for(int i = 0; i < 2048; i++)
	{
		#ifdef	D_32BIT
		m_FrameBuffer[i] = (unsigned long *)pMem/*g_infoDrv.pcMem*/ + i * g_infoDrv.nX;
		#else
		m_FrameBuffer[i] = (unsigned short *)pMem/*g_infoDrv.pcMem*/ + i * g_infoDrv.nX;
		#endif
	}	
}

CtmGDIDoubleBuffer::~CtmGDIDoubleBuffer()
{
	DestroyBuffer();
}
void CtmGDIDoubleBuffer::InitFrameBuffer()
{
	
	//for(int i = 0; i < g_infoDrv.nY; i++)
	for(int i = 0; i < 2048; i++)
	{
		#ifdef	D_32BIT
		m_FrameBuffer[i] = (unsigned long *)pMem/*g_infoDrv.pcMem*/ + i * g_infoDrv.nX;
		#else
		m_FrameBuffer[i] = (unsigned short *)pMem/*g_infoDrv.pcMem*/ + i * g_infoDrv.nX;
		#endif
	}		
}

BOOL	CtmGDIDoubleBuffer::CreateBuffer()
{
	DestroyBuffer();
	
	BOOL	bResult = FALSE;	
	unsigned long*	pTest[50];
	//printf("m_rect.bottom=%d m_rect.top=%d value=%d right=%d left=%d \n", m_rect.bottom, m_rect.top, m_rect.bottom - m_rect.top + 1, 
	//m_rect.right, m_rect.left);
	#ifdef	D_32BIT
	m_pBuffer = (unsigned long**)malloc((m_rect.bottom - m_rect.top + 1)*sizeof(unsigned long*));//new unsigned short* [(m_rect.bottom - m_rect.top + 1)];
	#else
	m_pBuffer = (unsigned short**)malloc((m_rect.bottom - m_rect.top + 1)*sizeof(unsigned short*));//new unsigned short* [(m_rect.bottom - m_rect.top + 1)];
	#endif
	if (m_pBuffer != NULL)
	{
		bResult = TRUE;
		//printf("Crate 2 m_rect.right=%d left=%d bottom=%d, top=%d \n", m_rect.right, m_rect.left, m_rect.bottom, m_rect.top);
		for (int i = 0; i < (m_rect.bottom - m_rect.top + 1); i++)
		{
			//printf("i=%d len=%d \n", i, m_rect.right - m_rect.left + 1);
			#ifdef	D_32BIT
			*(m_pBuffer + i) = (unsigned long *)malloc((m_rect.right - m_rect.left + 1)*sizeof(unsigned long ));
			//pTest[i] = new unsigned long[(m_rect.right - m_rect.left + 1)];
			#else
			*(m_pBuffer + i) = (unsigned short *)malloc((m_rect.right - m_rect.left + 1)*sizeof(unsigned short ));//new unsigned short [(m_rect.right - m_rect.left + 1)];
			#endif
			//printf("2 i=%d \n", i);
		}
	}
	//printf("CreateBuffer() 3 \n");
	return bResult;
	
	
}

void	CtmGDIDoubleBuffer::DestroyBuffer()
{
	if (m_pBuffer != NULL)
	{
		for (int i = 0; i < m_rect.bottom - m_rect.top + 1; i++)
		{
			//delete [](*(m_pBuffer + i));
			free(*(m_pBuffer + i));
			*(m_pBuffer + i)=NULL;
		}
		//delete []m_pBuffer;
		free(m_pBuffer);
		m_pBuffer = NULL;
	}
		
}

int		CtmGDIDoubleBuffer::GetPerLen()
{
	return m_nPerLen;
}

void	CtmGDIDoubleBuffer::SetRegion(RECT rect)
{
	int Temp = 0;
	if(rect.left > rect.right) 
	{
		Temp		= rect.right;
		rect.right	= rect.left;
		rect.left	= Temp;
	}
	if(rect.top > rect.bottom)
	{
		Temp		= rect.bottom;
		rect.bottom	= rect.top;
		rect.top	= Temp;
	}
	
	
	if (m_rect.left == rect.left 	&& m_rect.right == rect.right && 
		m_rect.top == rect.top 		&& m_rect.bottom == rect.bottom)
	;
	else
	{
		m_rect 	= rect;
		m_nXMax	= rect.right - rect.left;
		m_nYMax	= rect.bottom - rect.top;
		m_nXMin	= 0;
		m_nYMin	= 0;
		CreateBuffer();
	}
		
}

//	®œ•Œ¨Y∫ÿ√C¶‚∂Ò•Rdoublebuffer∞œ∞Ï
int		CtmGDIDoubleBuffer::InitBuffer(int Color)
{
	int Result = 0;
	DWORD Bit24Color=0;
	
	Bit24Color=RGB565TORGB888(Color);
	
	for (int i = 0; i < (m_rect.bottom - m_rect.top + 1); i++)
	{
		for (int j = 0; j < (m_rect.right - m_rect.left + 1); j++)
		{
			#ifdef	D_32BIT
			m_pBuffer[i][j] = Bit24Color;
			#else
			m_pBuffer[i][j] = (unsigned short)Color;
			#endif
			////printf("%X=%d\n", &m_pBuffer[i][j], m_pBuffer[i][j]);
			Result++;
		}
	}
	return Result;
}

//	®œ•ŒFrameBuffer§§copy doublebuffer∞œ∞Ï
int		CtmGDIDoubleBuffer::InitBuffer()
{
	int nResult = 0;
	#ifdef	D_32BIT
	unsigned long* 		pobjective;
	unsigned long*		pBuffer;
	#else
	unsigned short* 	pobjective;
	unsigned short*		pBuffer;
	#endif
	int	TempLen = 0;
	int XCycleTime = 0, XSpareTime = 0;
	XCycleTime = (m_rect.right - m_rect.left + 1) / m_nPerLen; 		//	x coordinate axis cycle Num
	XSpareTime = (m_rect.right - m_rect.left + 1) % m_nPerLen;		// 	x coordinate axis spare Num

	for(int i = m_rect.top ;i <= m_rect.bottom; i++)
	{
		pobjective = &m_FrameBuffer[i][m_rect.left];
		TempLen = 0;
		for(int j = 0; j < XCycleTime; j ++)
		{
			#ifdef	D_32BIT
			memcpy(&m_pBuffer[i - m_rect.top][TempLen],pobjective,sizeof(unsigned long)*m_nPerLen);
			#else
			memcpy(&m_pBuffer[i - m_rect.top][TempLen],pobjective,sizeof(unsigned short)*m_nPerLen);
			#endif
			TempLen += m_nPerLen;
			pobjective += m_nPerLen;
		}
		if(XSpareTime != 0)
		{			
			#ifdef	D_32BIT
			memcpy(&m_pBuffer[i - m_rect.top][TempLen],pobjective,sizeof(unsigned long)*XSpareTime);
			#else
			memcpy(&m_pBuffer[i - m_rect.top][TempLen],pobjective,sizeof(unsigned short)*XSpareTime);
			#endif
			TempLen += XSpareTime;
		}
	}	
	return nResult;	
}

void	CtmGDIDoubleBuffer::DrawWithDoubleBuffer()
{
	#ifdef	D_32BIT
	unsigned long* 		pobjective;
	unsigned long*		pBuffer;
	#else
	unsigned short* 	pobjective;
	unsigned short*		pBuffer;// = &m_pBuffer[0][0];
	#endif
	int	TempLen = 0;
	int XCycleTime = 0, XSpareTime = 0;
	XCycleTime = (m_rect.right - m_rect.left + 1) / m_nPerLen; 		//	x coordinate axis cycle Num
	XSpareTime = (m_rect.right - m_rect.left + 1) % m_nPerLen;		// 	x coordinate axis spare Num
	////printf("cycle =%d,Spare=%d\n", XCycleTime, XSpareTime);
	for(int i = m_rect.top ;i <= m_rect.bottom; i++)
	{
		pobjective = &m_FrameBuffer[i][m_rect.left];
		TempLen = 0;
		for(int j = 0; j < XCycleTime; j ++)
		{
			//if(memcmp(&m_pBuffer[i - m_rect.top][TempLen],pobjective,sizeof(unsigned short)*m_nPerLen) != 0)
			{
				#ifdef	D_32BIT
				memcpy(pobjective,&m_pBuffer[i - m_rect.top][TempLen],sizeof(unsigned long)*m_nPerLen);
				#else
				memcpy(pobjective,&m_pBuffer[i - m_rect.top][TempLen],sizeof(unsigned short)*m_nPerLen);
				#endif
			}
			//pBuffer += m_nPerLen;
			TempLen += m_nPerLen;
			pobjective += m_nPerLen;
		}
		if(XSpareTime != 0)
		{
			//if(memcmp(&m_pBuffer[i - m_rect.top][TempLen],pobjective,sizeof(unsigned short)*XSpareTime) != 0)
			{	
				#ifdef	D_32BIT
				memcpy(pobjective,&m_pBuffer[i - m_rect.top][TempLen],sizeof(unsigned long)*XSpareTime);
				#else
				memcpy(pobjective,&m_pBuffer[i - m_rect.top][TempLen],sizeof(unsigned short)*XSpareTime);
				#endif
			}
			//pBuffer += XSpareTime;
			TempLen += XSpareTime;
		}
	}
}

void	CtmGDIDoubleBuffer::DrawWithDoubleBuffer(int x, int y, int nStartX, int nStartY, int nEndX, int nEndY)
{
	#ifdef	D_32BIT
	unsigned long* 		pobjective;
	unsigned long*		pBuffer;
	#else
	unsigned short* 	pobjective;
	unsigned short*		pBuffer;// = &m_pBuffer[0][0];
	#endif
	int	TempLen = 0;
	int XCycleTime = 0, XSpareTime = 0;
	XCycleTime = (nEndX - nStartX + 1) / m_nPerLen; 		//	x coordinate axis cycle Num
	XSpareTime = (nEndX - nStartX + 1) % m_nPerLen;		// 	x coordinate axis spare Num
	for(int i = m_rect.top ;i <= m_rect.bottom; i++)
	{
		pobjective = &m_FrameBuffer[i+y][m_rect.left+x];
		TempLen = 0;
		
		//#ifdef	D_32BIT
		//memcpy(pobjective,&m_pBuffer[i - m_rect.top][TempLen + nStartX],sizeof(unsigned long)*(nEndX - nStartX + 1));
		//#else
		//memcpy(pobjective,&m_pBuffer[i - m_rect.top][TempLen + nStartX],sizeof(unsigned short)*(nEndX - nStartX + 1));
		//#endif
		
		for(int j = 0; j < XCycleTime; j ++)
		{
			//if(memcmp(&m_pBuffer[i - m_rect.top][TempLen],pobjective,sizeof(unsigned short)*m_nPerLen) != 0)
			{
				#ifdef	D_32BIT
				memcpy(pobjective,&m_pBuffer[i - m_rect.top][TempLen + nStartX],sizeof(unsigned long)*m_nPerLen);
				#else
				memcpy(pobjective,&m_pBuffer[i - m_rect.top][TempLen + nStartX],sizeof(unsigned short)*m_nPerLen);
				#endif
			}
			//pBuffer += m_nPerLen;
			TempLen += m_nPerLen;
			pobjective += m_nPerLen;
		}
		if(XSpareTime != 0)
		{
			//if(memcmp(&m_pBuffer[i - m_rect.top][TempLen],pobjective,sizeof(unsigned short)*XSpareTime) != 0)
			{	
				#ifdef	D_32BIT
				memcpy(pobjective,&m_pBuffer[i - m_rect.top][TempLen + nStartX],sizeof(unsigned long)*XSpareTime);
				#else
				memcpy(pobjective,&m_pBuffer[i - m_rect.top][TempLen + nStartX],sizeof(unsigned short)*XSpareTime);
				#endif
			}
			//pBuffer += XSpareTime;
			TempLen += XSpareTime;
		}
	}
}

void	CtmGDIDoubleBuffer::MoveToInBuffer(int x, int y)
{
	m_nCurrent_X = x;
	m_nCurrent_Y = y;
}

void	CtmGDIDoubleBuffer::SetColorInBuffer(int Color)
{
	#ifdef	D_32BIT
	DWORD Bit24Color=0;
	Bit24Color=RGB565TORGB888(Color);
	m_nColor = Bit24Color;
	#else
	m_nColor = Color; 
	#endif
}

void	CtmGDIDoubleBuffer::DrawPointInBuffer(int x, int y, int Color)
{
	#ifdef	D_32BIT
	int Bit24Color=0;
	
	Bit24Color=RGB565TORGB888(Color);
	switch(m_nWriteMode)
	{
	case _GPSET:
		m_pBuffer[y][x] = Bit24Color;	
		break;
	case _GXOR:
		m_pBuffer[y][x] ^= Bit24Color;
		break;
	}
	#else
	switch(m_nWriteMode)
	{
	case _GPSET:
		m_pBuffer[y][x] = Color;	
		break;
	case _GXOR:
		m_pBuffer[y][x] ^= Color;
		break;
	}
	#endif
	
}

void	CtmGDIDoubleBuffer::DrawVLineInBuffer(int y1, int y2, int x)
{
	//unsigned short** pSource = m_pBuffer;
	if (x < 0 || y1 < 0 || y2 < 0) return;
	int y;
	if (y1 > y2)
	{
		y = y2;
		y2 = y1;
		y1 = y;
	}
	
	switch(m_nWriteMode)
	{
	case _GPSET:
		for(int i = y1; i <= y2; i++)
			m_pBuffer[i][x]	= m_nColor;
		break;
	case _GXOR:
		for(int i = y1; i <= y2; i++)
			m_pBuffer[i][x]   ^= m_nColor;
		break;
	}
}

void	CtmGDIDoubleBuffer::DrawHLineInBuffer(int x1, int x2, int y)
{
	//unsigned short** pSource = m_pBuffer;
	if (y < 0 || x1 < 0 || x2 < 0) return;
	int x;
	if (x1 > x2)
	{
		x = x2;
		x2 = x1;
		x1 = x;
	}
	
	switch(m_nWriteMode)
	{
	case _GPSET:
		for (int i = x1; i <= x2; i++)
			m_pBuffer[y][i]	= m_nColor;
		break;
	case _GXOR:
		for (int i = x1; i <= x2; i++)
			m_pBuffer[y][i]   ^= m_nColor;
		break;
	}
}

void	CtmGDIDoubleBuffer::DrawLineInBuffer(int x1, int y1, int x2, int y2)
{
	//unsigned short** pSource = m_pBuffer;
	if (x1 < 0 || y1 < 0 || x2 < 0 || y2 < 0) return;
	int dx, dy;
	int	x,	y;
	int	const1,	const2;
	int p, tmp, inc;
	
	dx	= x2 - x1;
	dy	= y2 - y1;
	
	x	= x1;
	y	= y1;
	
	if(dx * dy > 0)
		inc	= 1;
	else
		inc	= -1;
	
	if(abs(dx) > abs(dy))
	{
		if(dx < 0)
		{
			/*±N2a, 3a∂H≠≠§Ë¶V™∫™ΩΩu≈‹¥´®Ï1a, 4a∂H≠≠§Ë¶V•h*/
			tmp	= x1; 				
			x1	= x2;
			x2	= tmp;
			y	= y2;
		}
		dx	= abs(dx);
		dy	= abs(dy);
		
		p		= 2 * dy - dx;
		const1	= 2 * dy;
		const2	= 2 * (dy - dx);
		
		for(x = x1; x <= x2; x++)
		{
			m_pBuffer[y][x]	= m_nColor;
			if(p < 0)
				p	+= const1;
			else
			{
				p	+= const2;
				y	+= inc;
			} 
		}
	}
	else
	{
		if (dy < 0)
		{
			/* ±N3b, 4b∂H≠≠§Ë¶V™∫™ΩΩu≈‹¥´®Ï2b, 1b∂H≠≠§Ë¶V•h. */
			tmp	= y1; 		
			y1	= y2; 			
			y2	= tmp;			
			x	= x2;
		}
		dx	= abs(dx);
		dy	= abs(dy);
		
		
		p		= 2 * dx - dy;
		const1	= 2 * dx;
		const2	= 2 * (dx - dy);

		for(y = y1; y <= y2; y++)
		{			
			m_pBuffer[y][x]	= m_nColor;
			if(p < 0)
				p	+= const1;
			else
			{
				p	+= const2;
				x	+= inc;
			}
		}
	}
}

void	CtmGDIDoubleBuffer::DrawLineToInBuffer(int x, int y)
{
	if (x == m_nCurrent_X)
	{
		DrawVLineInBuffer(m_nCurrent_Y, y, x);
	}
	else if (y == m_nCurrent_Y)
	{
		DrawHLineInBuffer(m_nCurrent_X, x, y);
	}
	else
	{
		DrawLineInBuffer(m_nCurrent_X, m_nCurrent_Y, x, y);
	}
	
	m_nCurrent_X = x;
	m_nCurrent_Y = y;
}

void	CtmGDIDoubleBuffer::DrawRectangleInBuffer(int Control, int x1, int y1, int x2, int y2)
{
//	unsigned short** pSource = m_pBuffer;
	if (x1 < 0 || y1 < 0 || x2 < 0 || y2 < 0) return;
		
	int	i,	j, temp;
	//µeØxßŒ
	if(Control == _GBORDER)	
	{
		DrawVLineInBuffer(y1, y2, x1);	
		DrawHLineInBuffer(x1, x2, y2);
		DrawVLineInBuffer(y2, y1, x2);
		DrawHLineInBuffer(x2, x1, y1);	
		return ;
	}
	
	//∂Ò•RØxßŒ
	if(x1 > x2)
	{
		temp	= x1;
		x1		= x2;
		x2		= temp;
	}	
	if(y1 > y2)
	{
		temp	= y1;
		y1		= y2;
		y2		= y1;
	}
	
	for(i = y1; i <= y2; i ++)
	{
		for (j = x1; j <= x2; j ++)
			m_pBuffer[i][j]	= m_nColor;
	}
}


void	CtmGDIDoubleBuffer::SetFillRegInBuffer(int x1, int y1, int x2, int y2)
{
	m_nXMin = x1;
	m_nYMin	= y1;
	m_nXMax	= x2;
	m_nYMax	= y2;
}

void	CtmGDIDoubleBuffer::FillInBuffer(DWORD wFillType, WORD wBordeColor, WORD wFillColor, int x1, int y1,  
				WORD wDestColor, int nChange)
{
	DWORD BordeColor=0;
	DWORD FillColor =0;
	#ifdef	D_32BIT
	
	BordeColor=RGB565TORGB888(wBordeColor);
	FillColor=RGB565TORGB888(wFillColor);
	#else
	BordeColor=wBordeColor;
	FillColor = wFillColor;
	#endif
	if(x1 > m_nXMax || x1 < m_nXMin || y1 > m_nYMax || y1 < m_nYMin)
		return ; 
	if(x1 < m_nXMin)	x1	= m_nXMin;
	if(y1 < m_nYMin)	y1	= m_nYMin;
		
		
	WORD	wTemp = 0;
	BYTE	r, g, b, r1, g1, b1, rTemp, gTemp, bTemp = 0;
	_ColorToRGB(wFillColor, &r, &g, &b);	
	_ColorToRGB(wDestColor, &r1, &g1, &b1);
	
	
	if (wFillType & _COLOR_XCHANGE)		//	the color changes with the x
	{
		if (nChange == -1 ||
			(!(_COLOR_INDE & wFillType) && !(_COLOR_DEIN & wFillType)) )	
			nChange = m_nXMax;
		
		int	nRange = nChange - m_nXMin + 1;
		
		//printf("buffer filel xmax=%d, xmin=%d, nRange=%d\n", m_nXMax, m_nXMin, nRange);
		for (int i = m_nXMin, ii = i - m_nXMin + 1; i <= x1 ; i++, ii++)
		{
			if (_COLOR_INCRESE & wFillType)
				#ifdef	D_32BIT
				FillColor = RGB2PIXEL888(	r + (r1 - r) * ii / nRange, 
										g + (g1 - g) * ii / nRange, 
										b + (b1 - b) * ii / nRange);
				#else
				FillColor = RGB2PIXEL(	r + (r1 - r) * ii / nRange, 
										g + (g1 - g) * ii / nRange, 
										b + (b1 - b) * ii / nRange);
				#endif
			else if (_COLOR_DECRESE & wFillType)
				#ifdef	D_32BIT
				FillColor = RGB2PIXEL888(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
				#else
				FillColor = RGB2PIXEL(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
				#endif
			else if (_COLOR_INDE & wFillType)
			{
				if (i <= nChange)
				{
					#ifdef	D_32BIT
					FillColor = RGB2PIXEL888(	r + (r1 - r) * ii / nRange, 
											g + (g1 - g) * ii / nRange, 
											b + (b1 - b) * ii / nRange);
					#else
					FillColor = RGB2PIXEL(	r + (r1 - r) * ii / nRange, 
											g + (g1 - g) * ii / nRange, 
											b + (b1 - b) * ii / nRange);
					#endif
					//printf("1 increse color[%d]=%d\n", i, wFillColor);										
				}
				else
				{
					nRange = m_nXMax - nChange + 1;
					
					//ii = nRange - (m_nYMax - i);
						//m_nYMax - nChange + 1 - (m_nYMax - i);
					ii = i + 1 - nChange;
					#ifdef	D_32BIT
					FillColor = RGB2PIXEL888(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
					#else
					FillColor = RGB2PIXEL(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
					#endif
					//printf("1 decrese color[%d]=%d\n", i, wFillColor);
				}
			}
			else if (_COLOR_DEIN & wFillType)
			{
				
			}
			
			
			
			for (int j = y1; j >= m_nYMin; j--)
			{
				if (m_pBuffer[j][i] == BordeColor)
					break;
				else
					m_pBuffer[j][i] = FillColor;
			}
			
			for (int j = y1 + 1; j <= m_nYMax; j++)
			{
				if (m_pBuffer[j][i] == BordeColor)
					break;
				else
					m_pBuffer[j][i] = FillColor;
			}
		}
		
		for (int i = x1 + 1, ii = i - m_nXMin + 1; i <= m_nXMax; i++, ii++)
		{
			if (_COLOR_INCRESE & wFillType)
				#ifdef	D_32BIT
				FillColor = RGB2PIXEL888(	r + (r1 - r) * ii / nRange, 
										g + (g1 - g) * ii / nRange, 
										b + (b1 - b) * ii / nRange);
				#else
				FillColor = RGB2PIXEL(	r + (r1 - r) * ii / nRange, 
										g + (g1 - g) * ii / nRange, 
										b + (b1 - b) * ii / nRange);
				#endif
			else if (_COLOR_DECRESE & wFillType)
				#ifdef	D_32BIT
				FillColor = RGB2PIXEL888(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
				#else
				FillColor = RGB2PIXEL(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
				#endif
			else if (_COLOR_INDE & wFillType)
			{
				if (i <= nChange)
				{
					#ifdef	D_32BIT
					FillColor = RGB2PIXEL888(	r + (r1 - r) * ii / nRange, 
											g + (g1 - g) * ii / nRange, 
											b + (b1 - b) * ii / nRange);
					#else
					FillColor = RGB2PIXEL(	r + (r1 - r) * ii / nRange, 
											g + (g1 - g) * ii / nRange, 
											b + (b1 - b) * ii / nRange);
					#endif
					//printf("2 increse color[%d]=%d\n", i, wFillColor);										
				}
				else
				{
					//ii = nRange - (m_nYMax - i);
					ii = i + 1 - nChange;	
					#ifdef	D_32BIT
					FillColor = RGB2PIXEL888(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
					#else
					FillColor = RGB2PIXEL(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
					#endif
					//printf("2 decrese color[%d]=%d\n", i, wFillColor);
					
				}
				
			}
			else if (_COLOR_DEIN & wFillType)
			{
				
			}
			
			for (int j = y1; j >= m_nYMin; j--)
			{
				if (m_pBuffer[j][i] == BordeColor)
					break;
				else
					m_pBuffer[j][i] = FillColor;
			}
			
			for (int j = y1 + 1; j <= m_nYMax; j++)
			{
				if (m_pBuffer[j][i] == BordeColor)
					break;
				else
					m_pBuffer[j][i] = FillColor;
			}		
		}
		
	}
	else								//	the color changes with the y
	{
		if (nChange == -1 || 
			(!(_COLOR_INDE & wFillType) && !(_COLOR_DEIN & wFillType)) )	
			nChange = m_nYMax;
		
		int		nRange =  nChange - m_nYMin + 1;
		for (int i = m_nYMin, ii = i - m_nYMin + 1; i <= y1 ; i++, ii++)
		{
			if (_COLOR_INCRESE & wFillType)
				#ifdef	D_32BIT
				FillColor = RGB2PIXEL888(	r + (r1 - r) * ii / nRange, 
										g + (g1 - g) * ii / nRange, 
										b + (b1 - b) * ii / nRange);
				#else
				FillColor = RGB2PIXEL(	r + (r1 - r) * ii / nRange, 
										g + (g1 - g) * ii / nRange, 
										b + (b1 - b) * ii / nRange);
				#endif
			else if (_COLOR_DECRESE & wFillType)
				#ifdef	D_32BIT
				FillColor = RGB2PIXEL888(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
				#else
				FillColor = RGB2PIXEL(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
				#endif
			else if (_COLOR_INDE & wFillType)
			{
				if (i <= nChange)
				{
					#ifdef	D_32BIT
					FillColor = RGB2PIXEL888(	r + (r1 - r) * ii / nRange, 
											g + (g1 - g) * ii / nRange, 
											b + (b1 - b) * ii / nRange);
					#else
					FillColor = RGB2PIXEL(	r + (r1 - r) * ii / nRange, 
											g + (g1 - g) * ii / nRange, 
											b + (b1 - b) * ii / nRange);
					#endif
					////printf("1 increse color[%d]=%d\n", i, wFillColor);										
				}
				else
				{
					nRange = m_nYMax - nChange + 1;
					
					//ii = nRange - (m_nYMax - i);
						//m_nYMax - nChange + 1 - (m_nYMax - i);
					ii = i + 1 - nChange;
					#ifdef	D_32BIT
					FillColor = RGB2PIXEL888(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
					#else
					FillColor = RGB2PIXEL(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
					#endif
					////printf("1 decrese color[%d]=%d\n", i, wFillColor);
				}
			}
			else if (_COLOR_DEIN & wFillType)
			{
				
			}
			
			
			
			for (int j = x1; j >= m_nXMin; j--)
			{
				if (m_pBuffer[i][j] == BordeColor)
					break;
				else
					m_pBuffer[i][j] = FillColor;
			}
			
			for (int j = x1 + 1; j <= m_nXMax; j++)
			{
				if (m_pBuffer[i][j] == BordeColor)
					break;
				else
					m_pBuffer[i][j] = FillColor;
			}
		}
		
		
		for (int i = y1 + 1, ii = i - m_nYMin + 1; i <= m_nYMax; i++, ii++)
		{
			if (_COLOR_INCRESE & wFillType)
				#ifdef	D_32BIT
				FillColor = RGB2PIXEL888(	r + (r1 - r) * ii / nRange, 
										g + (g1 - g) * ii / nRange, 
										b + (b1 - b) * ii / nRange);
				#else
				FillColor = RGB2PIXEL(	r + (r1 - r) * ii / nRange, 
										g + (g1 - g) * ii / nRange, 
										b + (b1 - b) * ii / nRange);
				#endif										
			else if (_COLOR_DECRESE & wFillType)
				#ifdef	D_32BIT
				FillColor = RGB2PIXEL888(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
				#else
				FillColor = RGB2PIXEL(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
				#endif										
			else if (_COLOR_INDE & wFillType)
			{
				if (i <= nChange)
				{
					#ifdef	D_32BIT
					FillColor = RGB2PIXEL888(	r + (r1 - r) * ii / nRange, 
											g + (g1 - g) * ii / nRange, 
											b + (b1 - b) * ii / nRange);
					#else
					FillColor = RGB2PIXEL(	r + (r1 - r) * ii / nRange, 
											g + (g1 - g) * ii / nRange, 
											b + (b1 - b) * ii / nRange);
					#endif
					////printf("2 increse color[%d]=%d\n", i, wFillColor);										
				}
				else
				{
					//ii = nRange - (m_nYMax - i);
					ii = i + 1 - nChange;	
				
					#ifdef	D_32BIT
					FillColor = RGB2PIXEL888(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
					#else
					FillColor = RGB2PIXEL(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
					#endif					
					////printf("2 decrese color[%d]=%d\n", i, wFillColor);
					
				}
				
			}
			else if (_COLOR_DEIN & wFillType)
			{
				
			}
			
			for (int j = x1; j >= m_nXMin; j--)
			{
				if (m_pBuffer[i][j] == BordeColor)
					break;
				else
					m_pBuffer[i][j] = FillColor;
			}
			
			for (int j = x1 + 1; j <= m_nXMax; j++)
			{
				if (m_pBuffer[i][j] == BordeColor)
					break;
				else
					m_pBuffer[i][j] = FillColor;
			}		
		}
	}
}

void	CtmGDIDoubleBuffer::FillRectInBuffer(DWORD wFillType, WORD wBordeColor, WORD wFillColor, 
			  int x1, int y1, int x2, int y2, 
			  WORD wDestColor, int nChange)
{
	DWORD BordeColor=0;
	DWORD FillColor =0;
	#ifdef	D_32BIT
	
	BordeColor=RGB565TORGB888(wBordeColor);
	FillColor =RGB565TORGB888(wFillColor);
	#else
	BordeColor=wBordeColor;
	FillColor = wFillColor;
	#endif
	
	int temp = 0;
	//∂Ò•RØxßŒ
	if(x1 > x2)
	{
		temp	= x1;
		x1		= x2;
		x2		= temp;
	}	
	if(y1 > y2)
	{
		temp	= y1;
		y1		= y2;
		y2		= y1;
	}
	
	//ßP¬_´Ãπıß§º–¨Oß_ßπ•˛∂W•XViewPort≠S≥Ú°C
	if(x1 > m_nXMax || x2 < m_nXMin 
			|| y1 > m_nYMax || y2 < m_nYMin)
		return ; 
	if(x1 < m_nXMin)	x1	= m_nXMin;
	if(y1 < m_nYMin)	y1	= m_nYMin;
	if(x2 > m_nXMax)	x2	= m_nXMax;
	if(y2 > m_nYMax)	y2	= m_nYMax;

		
		
	WORD	wTemp = 0;
	BYTE	r, g, b, r1, g1, b1, rTemp, gTemp, bTemp = 0;
	//printf("wFillColor=%d,wDestColor=%d\n",wFillColor,wDestColor);
	_ColorToRGB(wFillColor, &r, &g, &b);	
	_ColorToRGB(wDestColor, &r1, &g1, &b1);
	//printf("ex:r=%d,g=%d,b=%d,\
			//r1=%d,g1=%d,b1=%d\n",r,g,b,r1,g1,b1);
	
	
	if (wFillType & _COLOR_XCHANGE)		//	the color changes with the x
	{
		//printf("_COLOR_XCHANGE=%d\n",wFillType);
		if (nChange == -1 ||
			(!(_COLOR_INDE & wFillType) && !(_COLOR_DEIN & wFillType)) )	
			nChange = x2-x1;
		
		int	nRange = nChange  + 1;
		
		
		
		for (int i = x1, ii = i - x1 + 1; i <= x2; i++, ii++)
		{
			if (_COLOR_INCRESE & wFillType)
				#ifdef	D_32BIT
				FillColor = RGB2PIXEL888(	r + (r1 - r) * ii / nRange, 
										g + (g1 - g) * ii / nRange, 
										b + (b1 - b) * ii / nRange);
				#else
				FillColor = RGB2PIXEL(	r + (r1 - r) * ii / nRange, 
										g + (g1 - g) * ii / nRange, 
										b + (b1 - b) * ii / nRange);
				#endif										
			else if (_COLOR_DECRESE & wFillType)
				#ifdef	D_32BIT
				FillColor = RGB2PIXEL888(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
				#else
				FillColor = RGB2PIXEL(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
				#endif										
			else if (_COLOR_INDE & wFillType)
			{
				if ((i-x1+1) <= nChange)
				{
					#ifdef	D_32BIT
					FillColor = RGB2PIXEL888(	r + (r1 - r) * ii / nRange, 
											g + (g1 - g) * ii / nRange, 
											b + (b1 - b) * ii / nRange);
					#else
					FillColor = RGB2PIXEL(	r + (r1 - r) * ii / nRange, 
											g + (g1 - g) * ii / nRange, 
											b + (b1 - b) * ii / nRange);
					#endif
					//printf("2 increse color[%d]=%d\n", i, wFillColor);										
				}
				else
				{
					//ii = nRange - (y2 - i);
					ii = i - x1 + 1 - nChange;	
					
					#ifdef	D_32BIT
					FillColor = RGB2PIXEL888(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
					#else
					FillColor = RGB2PIXEL(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
					#endif
					//printf("2 decrese color[%d]=%d\n", i, wFillColor);
					
				}
				
			}
			else if (_COLOR_DEIN & wFillType)
			{
				
			}
			
			for (int j = y1; j >= y1; j--)
			{
				m_pBuffer[j][i] = FillColor;
			}
			
			for (int j = y1 + 1; j <= y2; j++)
			{
				m_pBuffer[j][i] = FillColor;
			}		
		}
		
	}
	else								//	the color changes with the y
	{
		if (nChange == -1 || 
			(!(_COLOR_INDE & wFillType) && !(_COLOR_DEIN & wFillType)) )	
			nChange = y2- y1;
		
		int		nRange =  nChange + 1;
		
		//printf("ex:nChange=%d,y2=%d,y1=%d,nRange=%d\n",nChange,y2,y1,nRange);
		
		for (int i = y1, ii = i - y1 + 1; i <= y2; i++, ii++)
		{
			if (_COLOR_INCRESE & wFillType)
				#ifdef	D_32BIT
				FillColor = RGB2PIXEL888(	r + (r1 - r) * ii / nRange, 
										g + (g1 - g) * ii / nRange, 
										b + (b1 - b) * ii / nRange);
				#else
				FillColor = RGB2PIXEL(	r + (r1 - r) * ii / nRange, 
										g + (g1 - g) * ii / nRange, 
										b + (b1 - b) * ii / nRange);
				#endif										
			else if (_COLOR_DECRESE & wFillType)
				#ifdef	D_32BIT
				FillColor = RGB2PIXEL888(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
				#else
				FillColor = RGB2PIXEL(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
				#endif										
			else if (_COLOR_INDE & wFillType)
			{
				if ((i-y1+1) <= nChange)
				{
					#ifdef	D_32BIT
					FillColor = RGB2PIXEL888(	r + (r1 - r) * ii / nRange, 
											g + (g1 - g) * ii / nRange, 
											b + (b1 - b) * ii / nRange);
					#else
					FillColor = RGB2PIXEL(	r + (r1 - r) * ii / nRange, 
											g + (g1 - g) * ii / nRange, 
											b + (b1 - b) * ii / nRange);
					#endif
					////printf("2 increse color[%d]=%d\n", i, wFillColor);										
				}
				else
				{
					//ii = nRange - (y2 - i);
					ii = i -y1+1 - nChange;	
					
					#ifdef	D_32BIT
					FillColor = RGB2PIXEL888(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
					#else
					FillColor = RGB2PIXEL(	r1 - (r1 - r) * ii / nRange, 
										g1 - (g1 - g) * ii / nRange, 
										b1 - (b1 - b) * ii / nRange);
					#endif
					////printf("2 decrese color[%d]=%d\n", i, wFillColor);
					
				}
				
			}
			else if (_COLOR_DEIN & wFillType)
			{
				
			}
			
			for (int j = x1; j >= x1; j--)
			{
				m_pBuffer[i][j] = FillColor;
			}
			
			for (int j = x1 + 1; j <= x2; j++)
			{
				m_pBuffer[i][j] = FillColor;
			}		
		}
	}
}

#ifdef	D_32BIT
unsigned long** CtmGDIDoubleBuffer::GetBuffer()
#else
unsigned short** CtmGDIDoubleBuffer::GetBuffer()
#endif
{
	return m_pBuffer;
}
